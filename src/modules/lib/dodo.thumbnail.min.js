var dodo=(function(){var d=String.prototype.charCodeAt;var j=String.fromCharCode;var p=33;var o=36;var n=[];function q(G){var F=[];var I=G.length;for(var H=0;H<I;H+=2){var J=d.call(G,H)-p;var E=d.call(G,H+1)-p;F.push(j((J<<4)+E))}return F.join("")}function f(){var E=document.createElement("canvas");if(window.G_vmlCanvasManager){window.G_vmlCanvasManager.initElement(E)}return E}function c(){if(n.length>0){return n.shift()}return f()}function D(E){return n.push(E)}var k=q("(('&'#'('-");var m=q("'&()(!'&(#'*'.'&'/(%'\"'-#.(('&'#'('-");var i=q("'('&(%%$'0'/(%'&()(%");var b=q("'$'-'&'\"(#%$'0'-'0(#");var s=q("'$'-'&'\"(#");var a=q("%$%0%-%0&#&0%#&&%'%'%&&#&0%#%*&%");var B=q('%.%"&)&0&%%&&)&%&&&#%&&0%*%.%"%(%&&0&&%/%*&%&$');var v=q('%.%"&)&0&%%&&)&%&&&#%&&0&$%*&+%&');var l=q("'('&(%&!'\"(#'\"'.'&(%'&(#");function u(){var J=c();J.width=J.height=1;var F=(J[i](k)||J[i](m));if(F){F[b](1,0,0,1);F[s](F[a]);var H=f();H.width=H.height=1;var E=H.getContext("2d");E.drawImage(J,0,0);var I=E.getImageData(0,0,1,1);var G=I.data||I;if(G[0]==255){D(J);return{support:true,maxTextureCount:F[l](F[B]),maxTextureSize:F[l](F[v])}}}D(J);return{support:false}}function r(){var G=navigator.userAgent;var F=G.match(/(iPad).*OS\s([\d_]+)/),I=G.match(/(iPhone\sOS)\s([\d_]+)/),H=G.match(/(Android)\s+([\d.]+)/),E=F||I||H;return !!E}function t(){var G=navigator.userAgent;var F=G.match(/(iPad).*OS\s([\d_]+)/),H=G.match(/(iPhone\sOS)\s([\d_]+)/),E=F||H;return !!E}function A(){var E=navigator.userAgent.toLowerCase();return E.indexOf("safari")>0&&E.indexOf("chrome")<0}function h(){var E=navigator.userAgent.toLowerCase();return E.indexOf("firefox")>=0}if(typeof(window.console)=="undefined"){window.console={log:function(){}}}String.prototype.format=function(){var E=arguments;return this.replace(/\{(\d+)\}/g,function(){return E[arguments[1]]})};Array.prototype.indexOf=function(G){var E=this.length;for(var F=0;F<E;F++){if(this[F]==G){return F}}return -1};Array.prototype.remove=function(G){var E=this.length;for(var F=0;F<E;F++){if(this[F]==G){this.splice(F,1);return this}}return this};Array.prototype.insertAt=function(F,H){for(var G=F;G<this.length;G++){var E=this[G];this[G]=H;H=E}this.push(H)};var w=navigator.userAgent;var y="MicroMessenger";var g=w.indexOf(y)>=0;var z=u();var e=z.maxTextureSize;var x=e;if(z.support){if(z.maxTextureSize>4096){z.maxTextureSize=4096}if(g){e=z.maxTextureSize=z.maxTextureSize>>1}}var C={version:"3.0.0",MAX_CACHE:o,MAX_IMAGE_ON_SCREEN:15,MAX_CACHE_IMAGE:512,THUMB_SIZE:86,thumbWidth:90,isMobile:r(),isSafari:A(),isIOS:t(),isFirefox:h(),isWechat:g,isFastModel:z.support,maxTextureCount:z.maxTextureCount,maxTextureSize:z.maxTextureSize,stSize:e,stThreshold:x,isSupportWorker:typeof(window.Worker)!="undefined",debug:true,EMPTY_FN:function(){},FALSE_FN:function(){return false},decode:q,isFunction:function(E){return typeof(E)=="function"},isEmpty:function(E){return E===undefined||E===null},getValue:function(G,H,E){var F=G[H];if(this.isEmpty(F)&&(!this.isEmpty(E))){F=E}return F},apply:function(F,G){for(var E in G){F[E]=G[E]}return F},clear:function(H){var G=[];for(var F in H){G.push(F)}for(var E=0;E<G.length;E++){delete H[G[E]]}},getPropCount:function(G){if(typeof(G)!="object"){return 0}var E=0;for(var F in G){E++}return E},lm:function(G){var E=document.getElementById("testcanvas");var F=E.getContext("2d");F.fillText(G,30,30)},log:function(F){if(this.debug){if(arguments.length>1){var G=[];for(var E=1;E<arguments.length;E++){G.push(arguments[E])}F=String.prototype.format.apply(F,G)}console.log()}},createProxy:function(E,F){return function(){return F.apply(E,arguments)}},extend:function(H,G,F){if(G){var E=function(){};E.prototype=G.prototype;H.prototype=new E();H.prototype.constructor=H;H.superClass=H.prototype.superClass=G;if(F){this.apply(H.prototype,F)}}return H},getNearPower:function(F){var E=1;while(E<F){E=E<<1}return E},getOption:function(F,E){return this.getValue(this.option,F,E)},createElement:function(H,F){var I=document.createElement(H.tag||"div");var G=!!I.setAttribute;for(var E in H){if(E=="tag"){continue}if(E=="cls"){I.className=H.cls}else{try{if(G){I.setAttribute(E,H[E])}else{I[E]=H[E]}}catch(J){}}}if(F){F.appendChild(I)}return I},rotateX:function(G,F,E,J){var I=[],H=[];I[0]=F[0]-E[0];I[1]=F[1]-E[1];I[2]=F[2]-E[2];H[0]=I[0];H[1]=I[1]*Math.cos(J)-I[2]*Math.sin(J);H[2]=I[1]*Math.sin(J)+I[2]*Math.cos(J);G[0]=H[0]+E[0];G[1]=H[1]+E[1];G[2]=H[2]+E[2];return G},rotateY:function(G,F,E,J){var I=[],H=[];I[0]=F[0]-E[0];I[1]=F[1]-E[1];I[2]=F[2]-E[2];H[0]=I[2]*Math.sin(J)+I[0]*Math.cos(J);H[1]=I[1];H[2]=I[2]*Math.cos(J)-I[0]*Math.sin(J);G[0]=H[0]+E[0];G[1]=H[1]+E[1];G[2]=H[2]+E[2];return G},rotateZ:function(G,F,E,J){var I=[],H=[];I[0]=F[0]-E[0];I[1]=F[1]-E[1];I[2]=F[2]-E[2];H[0]=I[0]*Math.cos(J)-I[1]*Math.sin(J);H[1]=I[0]*Math.sin(J)+I[1]*Math.cos(J);H[2]=I[2];G[0]=H[0]+E[0];G[1]=H[1]+E[1];G[2]=H[2]+E[2];return G},createCanvas:f,getCanvas:c,recycleCanvas:D,getHolder:function(){if(!this._cacheHolder){this._cacheHolder=C.getCanvas()}return this._cacheHolder},isEmptyObject:function(F){for(var E in F){return false}return true},createLayoutTableIcon:function(I,L,H){var J=C.createElement({tag:"table",cls:"viewerLayoutIconTable"},I);var F=C.createElement({tag:"tbody"},J);for(var G=0;G<L;G++){var K=C.createElement({tag:"tr",height:20/L},F);for(var E=0;E<H;E++){C.createElement({tag:"td",width:20/H},K)}}},formatDate:function(E){if(!E){return"Unspecified"}if(typeof(E)=="string"&&E.indexOf("-")>=0){return E}return new Date(parseInt(E,10)).toLocaleDateString()},getParam:function(G,E){var F=RegExp("[?&]"+G+"=([^&]*)").exec(window.location.search);return F?decodeURIComponent(F[1].replace(/\+/g," ")):E}};window.setTimeout(function(){C.log("Dodo DICOM HTML5 Viewer {4} build {5}:FM={0},WK={1},WS={2},stThreshold={3}",C.isFastModel,C.isSupportWorker,!!window.WebSocket,C.stThreshold,C.version,C.build||"");if(window.console&&console.log){console.log()}},100);return C})();dodo.Object=(function(){function a(c,b){this.parent=c;this.option={};if(b){dodo.apply(this.option,b)}this.dodoObjectId=this.createUniqueId();this.toString=dodo.Object.prototype.toString()}a.prototype={clsName:"dodoObject",currentObjectId:1,createUniqueId:function(){return this.clsName+(a.prototype.currentObjectId++)},getOption:function(d,b){var c=dodo.getValue(this.option,d);if(dodo.isEmpty(c)&&this.parent&&this.parent.getOption){c=this.parent.getOption(d)}if(dodo.isEmpty(c)){c=b}return c},toString:function(){return this.dodoObjectId}};return a})();dodo.cache=(function(){function a(b){this.max=b||dodo.MAX_CACHE;this.cacheObjects={};this.cacheIds=[]}a.prototype={put:function(d,b){var c=this.cacheIds;if(c.indexOf(d)<0){c.push(d)}this.cacheObjects[d]=b;if(c.length>this.max){var d=c.shift();delete this.cacheObjects[d]}},get:function(b){return this.cacheObjects[b]}};return a})();dodo.cache.MAX_CACHE=dodo.MAX_CACHE;window.oncontextmenu=dodo.FALSE_FN;dodo.Asm=(function(){function p(I,B,z){var G=new I.Int32Array(z);var A=new I.Uint8Array(z);var F=I.Math.floor;var D=0;var H=0;var y=0;var C=0;var E=0;function J(N,M){N=+N;M=+M;var L=0;L=+(M-1);D=+(N-0.5-L/2);H=+(N-0.5+L/2);y=+(255/L);C=+(((N-0.5)/L-0.5)*255);E=+(C+255)}function K(O){O=O|0;var N=0;var M=3;var L=0;while((N|0)<(O|0)){A[N]=255;A[(N+1)|0]=255;A[(N+2)|0]=255;L=+(G[N>>2]|0);if(L<=D){A[M]=0}else{if(L<=H){A[M]=~~F(L*y-C)}else{A[M]=255}}N=(N+4)|0;M=(M+4)|0}}return{init:J,trans:K}}var o=dodo.decode;var v=o("%-%0&$&$&*");var b=o("%-%0&$&$%-%&&$&$");var d=255;var m=0;var g=0.5;var c=0.299;var k=0.587;var x=0.114;var e=-0.1687;var i=0.3313;var u=0.4187;var s=0.0813;function j(A){var z=A[0].pageX-A[1].pageX;var B=A[0].pageY-A[1].pageY;return Math.pow((z*z+B*B),0.5)}function f(F,C,E){var D=Math.round(F-g-(C-1)/2);var y=Math.round(F-g+(C-1)/2);var B=d/(C-1);var A=((F-g)/(C-1)-g)*d;var z=A+d;return E?function(L,K,J){for(var I=0,H=3;I<J;I++,H+=4){var G=L[I];(G<=D)?d:((G>y)?K[H]=0:(K[H]=z-G*B))}}:function(L,K,J){var I=0;var H=3;while(I<J){var G=L[I];if(G<=D){K[H]=0}else{if(G<=y){K[H]=G*B-A}}I++,H+=4}}}function h(F,C,E){var D=F-g-(C-1)/2;var y=F-g+(C-1)/2;var B=d/(C-1);var A=((F-g)/(C-1)-g)*d;var z=A+d;return E?function(J,I){for(var H=0;H<I;H++){var G=J[H];J[H++]=(G<=D)?d:((G>y)?0:(z-G*B));G=J[H];J[H++]=(G<=D)?d:((G>y)?0:(z-G*B));G=J[H];J[H++]=(G<=D)?d:((G>y)?0:(z-G*B))}}:function(J,I){for(var H=0;H<I;H++){var G=J[H];J[H++]=(G<=D)?0:((G>y)?d:(G*B-A));G=J[H];J[H++]=(G<=D)?0:((G>y)?d:(G*B-A));G=J[H];J[H++]=(G<=D)?0:((G>y)?d:(G*B-A))}}}var l={};function t(E,C,z,D,B){if(z==1&&D==0){for(var A=0,y=1;A<B;A++,y+=4){E[A]=(C[y]<<8)+C[y+1]}}else{if(z==1){for(var A=0,y=1;A<B;A++,y+=4){E[A]=(C[y]<<8)+C[y+1]+D}}else{for(var A=0,y=1;A<B;A++,y+=4){E[A]=((C[y]<<8)+C[y+1])*z+D}}}}var q="{0}"+b;for(var r=9;r<=16;r++){l[q.format(r)]=t}q="{0}"+v;for(var r=9;r<=12;r++){l[q.format(r)]=(function(y){var z=(y-7);return function(A,E,I,H,B){if(I==1&&H==0){for(var F=0,D=0;F<B;F++,D+=4){var G=Math.round(c*E[D]+k*E[D+1]+x*E[D+2]);var C=Math.round(e*E[D]-i*E[D+1]+g*E[D+2]);A[F]=((G-64)<<z)+C}}else{if(I==1){for(var F=0,D=0;F<B;F++,D+=4){var G=Math.round(c*E[D]+k*E[D+1]+x*E[D+2]);var C=Math.round(e*E[D]-i*E[D+1]+g*E[D+2]);A[F]=((G-64)<<z)+C+H}}else{for(var F=0,D=0;F<B;F++,D+=4){var G=Math.round(c*E[D]+k*E[D+1]+x*E[D+2]);var C=Math.round(e*E[D]-i*E[D+1]+g*E[D+2]);A[F]=(((G-64)<<z)+C)*I+H}}}}})(r)}for(var r=13;r<=16;r++){l[q.format(r)]=(function(z){var A=(z-7);var y=(z-12);return function(B,F,K,J,C){if(K==1&&J==0){for(var G=0,E=0;G<C;G++,E+=4){var I=Math.round(c*F[E]+k*F[E+1]+x*F[E+2]);var D=Math.round(e*F[E]-i*F[E+1]+g*F[E+2]);var H=Math.round(g*F[E]-u*F[E+1]-s*F[E+2]);B[G]=((I-64)<<A)+(D<<y)+H}}else{if(K==1){for(var G=0,E=0;G<C;G++,E+=4){var I=Math.round(c*F[E]+k*F[E+1]+x*F[E+2]);var D=Math.round(e*F[E]-i*F[E+1]+g*F[E+2]);var H=Math.round(g*F[E]-u*F[E+1]-s*F[E+2]);B[G]=((I-64)<<A)+(D<<y)+H+J}}else{for(var G=0,E=0;G<C;G++,E+=4){var I=Math.round(c*F[E]+k*F[E+1]+x*F[E+2]);var D=Math.round(e*F[E]-i*F[E+1]+g*F[E+2]);var H=Math.round(g*F[E]-u*F[E+1]-s*F[E+2]);B[G]=(((I-64)<<A)+(D<<y)+H)*K+J}}}}})(r)}var a=["y","b","r"];var w={y:7,b:5,r:5};function n(D){var C=[];var E=[];for(var B=0;B<3;B++){var z=B*2;E[B]=a.indexOf(D.substr(z,1));C[B]=parseInt(D.substr(z+1,1),10)}var A=(w[a[E[0]]]-C[0]);var y=(w[a[E[1]]]-C[1]);C[0]=C[1]+C[2];C[1]=C[2];return function(M,K,H,L,J){var F=[];if(H==1&&L==0){for(var I=0,G=0;I<J;I++,G+=4){F[0]=Math.round(c*K[G]+k*K[G+1]+x*K[G+2])-64;F[1]=Math.round(e*K[G]-i*K[G+1]+g*K[G+2]);F[2]=Math.round(g*K[G]-u*K[G+1]-s*K[G+2]);M[I]=(F[E[0]]>>A<<C[0])+(F[E[1]]>>y<<C[1])+F[E[2]]}}else{if(H==1){for(var I=0,G=0;I<J;I++,G+=4){F[0]=Math.round(c*K[G]+k*K[G+1]+x*K[G+2])-64;F[1]=Math.round(e*K[G]-i*K[G+1]+g*K[G+2]);F[2]=Math.round(g*K[G]-u*K[G+1]-s*K[G+2]);M[I]=(F[E[0]]>>A<<C[0])+(F[E[1]]>>y<<C[1])+F[E[2]]+L}}else{for(var I=0,G=0;I<J;I++,G+=4){F[0]=Math.round(c*K[G]+k*K[G+1]+x*K[G+2])-64;F[1]=Math.round(e*K[G]-i*K[G+1]+g*K[G+2]);F[2]=Math.round(g*K[G]-u*K[G+1]-s*K[G+2]);M[I]=((F[E[0]]>>A<<C[0])+(F[E[1]]>>y<<C[1])+F[E[2]])*H+L}}}}}return{grayWindowTrans:p,distance:j,CGWTF:f,DCFS:l,CLF:n,CCWTF:h}})();dodo.Lang=(function(){return{active:"cn",langs:{},setLang:function(c){var a=this.langs[c];if(!a){a=this.langs.cn}if(a&&dodo.msg!==a){dodo.msg=a;dodo.Lang.active=c;if(a.html){this.setDocumentTitle();var b=a.html;for(var d in b){if(d=="title"){continue}else{this.setHtml(d,b[d],document)}}}}},setHtml:function(d,b,a){var c=a?jQuery(d,a):jQuery(d);if(c.length==0){dodo.log(dodo.Lang.active+" lang error "+d+"="+(typeof(b)=="string"?b:JSON.stringify(b)));return}if(typeof(b)=="string"){return this.setText(c,b)}for(var e in b){if(e=="title"||e=="href"){c.attr(e,b[e])}else{if(e=="text"){this.setText(c,b[e])}else{if(e=="html"){c.html(b[e])}else{this.setHtml(e,b[e],c)}}}}},setText:function(a,b){if(a&&a.length>0){a.each(function(){var e=jQuery(this);var d=e.text();var c=e.html();e.html(c.replace(d,b))})}},setDocumentTitle:function(){var a=(dodo.request&&dodo.request.documentTitle)||dodo.Config.values.documentTitle||dodo.msg.html.title;var c=(a||"").format(dodo.version,dodo.build||"");if(dodo.UI){var b=dodo.UI.viewerData.viewer;if(b&&b.study&&b.study.title){c="{0}--{1}".format(b.study.title,c)}}document.title=c}}})();dodo.msg=dodo.Lang.langs.cn={name:"\u7B80\u4F53\u4E2D\u6587",BROWSER_ERROR:"\u672C\u8F6F\u4EF6\u57FA\u4E8EHTML5\u6280\u672F\u5EFA\u8BBE\uFF0C\u4E0D\u652F\u6301IE5\\6\\7\\8\u7B49\u53E4\u8001\u6D4F\u89C8\u5668\u8BBF\u95EE\u3002\r\n\u8BF7\u4F7F\u7528IE9\u4EE5\u4E0A\u6D4F\u89C8\u5668\u8BBF\u95EE,\u63A8\u8350\u4F7F\u7528IE11\u3001Chrome\u3001Firefox\u3001safri\u7B49\u6D4F\u89C8\u5668\u8BBF\u95EE\u3002",REQUEST_ERROR:"\u65E0\u6548\u7684\u68C0\u67E5\u5F71\u50CF\u8C03\u9605\u8BF7\u6C42.\r\n\u8BF7\u6838\u67E5\u6D4F\u89C8\u5668\u7248\u672C\u662F\u5426\u662F\u652F\u6301\u7684\u7248\u672C,\u53CA\u8C03\u9605\u53C2\u6570\u662F\u5426\u6B63\u786E\uFF01\r\n\u63A8\u8350\u4F7F\u7528IE11\u3001Edge\u3001Chrome\u3001Firefox\u3001Safri\u7B49\u6D4F\u89C8\u5668\u8BBF\u95EE\u3002",CHANGE_COMPRESS:"\u662F\u5426\u5207\u6362{0}\u6A21\u5F0F\uFF1F",AJAX_ERROR:"\u6570\u636E\u8BF7\u6C42\u51FA\u9519\uFF1A{0}",TOO_MANY_IMAGE_ERROR:"\u7531\u4E8E\u6D4F\u89C8\u5668\u6027\u80FD\u9650\u5236\uFF0C\u5728\u5C4F\u5E55\u4E0A\u6700\u591A\u53EA\u5141\u8BB8\u540C\u65F6\u5B58\u5728{0}\u4E2A\u5F71\u50CF\u663E\u793A\u533A\u57DF",CACHING_CONFIRM_MSG:"\u5F71\u50CF\u6B63\u5728\u540E\u53F0\u52A0\u8F7D\u4E2D\u3002\r\n\u73B0\u5728\u542F\u52A8\u64AD\u653E\u529F\u80FD\u53EF\u80FD\u5BFC\u81F4\u54CD\u5E94\u901F\u5EA6\u4E0D\u591F\u6D41\u7545\uFF0C\u5F71\u50CF\u52A0\u8F7D\u5B8C\u6210\u540E\u5C06\u83B7\u5F97\u6D41\u7545\u7684\u6D4F\u89C8\u901F\u5EA6\u3002\r\n\u662F\u5426\u7EE7\u7EED\u542F\u52A8\u64AD\u653E\u529F\u80FD\uFF1F",COMP_MODE:"\u517C\u5BB9\u6A21\u5F0F",SPEED_MODE:"\u6781\u901F\u6A21\u5F0F",IMAGE_DESC:"\u5171 {0} \u4E2A\u5E8F\u5217\uFF0C{1} \u4E2A\u5F71\u50CF\uFF0C\u5DF2\u7F13\u5B58 {2} \u4E2A\u5F71\u50CF\u3002",THREED_START:"\u6B63\u5728\u8FDB\u884C3\u7EF4\u91CD\u5EFA\uFF0C\u8BF7\u7A0D\u5019...",THREED_UNSUPPORT_SERIES:"\u5F53\u524D\u9009\u4E2D\u7684\u5E8F\u5217\u4E0D\u652F\u63013D MPR\u91CD\u5EFA.",THREED_UNSUPPORT_DEVICE:"\u5F53\u524D\u6D4F\u89C8\u5668\u6216\u8005\u8BBE\u5907\u4E0D\u652F\u63013D MPR\u91CD\u5EFA.\u9700\u8981IE11\u53CA\u6700\u65B0\u7684\u8C37\u6B4C\u548C\u706B\u72D0\u6D4F\u89C8\u5668\u3002",THREED_X_NAME:"\u51A0\u4F4D",THREED_Y_NAME:"\u77E2\u4F4D",THREED_Z_NAME:"\u8F74\u4F4D",THREED_MIP_NAME:"MIP",THREED_SSD_NAME:"SSD",THREED_VR_NAME:"\u5BB9\u79EF",THREED_TOO_BIG_SERIES:"\u5F53\u524D\u9009\u4E2D\u7684\u5E8F\u5217\u592A\u5927\uFF0C\u7EE7\u7EED\u8FDB\u884C3\u7EF4\u91CD\u5EFA\u53EF\u80FD\u5BFC\u81F4\u7A0B\u5E8F\u5D29\u6E83\u3002\u662F\u5426\u7EE7\u7EED\uFF1F",DRAW_MODE_NAME:"\u52FE\u753B\u6A21\u5F0F",CONF_START_MSG:"\u6B63\u5728\u8FDE\u63A5\u5F71\u50CF\u4F1A\u8BCA\u4F1A\u8BAE",CONF_DISCONNECTED_MSG:"\u5DF2\u65AD\u5F00\u5F71\u50CF\u4F1A\u8BCA\u4F1A\u8BAE",CONF_USER_JOIN:"{0}\u5DF2\u52A0\u5165\u5F53\u524D\u4F1A\u8BAE,\u5F53\u524D\u5171{1}\u4EBA,\u4F1A\u8BAE\u4E3B\u6301\u4E3A{2}",CONF_USER_LEFT:"{0}\u5DF2\u79BB\u5F00\u5F53\u524D\u4F1A\u8BAE,\u5F53\u524D\u5171{1}\u4EBA,\u4F1A\u8BAE\u4E3B\u6301\u4E3A{2}",CONF_USER_CHAIR:"\u5F53\u524D\u4F1A\u8BAE\u4E3B\u6301\u4EBA\u53D8\u66F4\u4E3A{0}",CONF_REQUEST_CHAIR:"{0}\u7533\u8BF7\u53D8\u66F4\u4E3A\u4F1A\u8BAE\u4E3B\u6301\u4EBA\uFF0C\u70B9\u3010\u786E\u5B9A\u3011\u6309\u94AE\u540C\u610F",CONF_USER_SHOW:"\u9009\u62E9\u663E\u793A\u68C0\u67E5{0}\u7684\u5E8F\u5217{1}\u56FE\u50CF{2}",annos:{dob:"\u51FA\u751F\u65E5\u671F\uFF1A",image:"\u56FE\u50CF:",series:"\u5E8F\u5217:",sdate:"\u68C0\u67E5\u65E5\u671F\uFF1A",columns:"\u5BBD:",rows:"/\u9AD8:",wl:"WL:",ww:"/WW:",scale:"\u7F29\u653E:",sliceThickness:"\u5C42\u539A:"},html:{title:"\u5FAE\u4E91\u5F71\u50CF V{0}---\u6781\u901F/\u4E13\u4E1A\u7684\u4E92\u8054\u7F51\u533B\u5B66\u5F71\u50CF\u6D4F\u89C8\u5668(HTML5 DICOM Viewer)","#imageSettings":{title:"\u4FEE\u6539\u8BBE\u7F6E\u4FE1\u606F","a span.toolbar-text":"\u8BBE\u7F6E",ul:{"li.relativeMode a":"\u9002\u5E94\u7A97\u53E3\u5927\u5C0F","li.absoluteMode a":"\u9002\u5E94\u56FE\u50CF\u5927\u5C0F","li.positionSync a":"\u4F4D\u7F6E\u540C\u6B65\u7FFB\u56FE","li.indexSync a":"\u7D22\u5F15\u540C\u6B65\u7FFB\u56FE","li.imageMode a":"\u64CD\u4F5C\u56FE\u50CF","li.seriesMode a":"\u64CD\u4F5C\u5E8F\u5217","li.studyMode a":"\u64CD\u4F5C\u68C0\u67E5","li.smoothMode a":"\u5E73\u6ED1\u7F29\u653E","li.rawMode a":"\u539F\u59CB\u7F29\u653E","li.lossyMode a":"\u6709\u635F\u538B\u7F29","li.losslessMode a":"\u65E0\u635F\u538B\u7F29","li.showBaseAnnoMode a":"\u663E\u793A\u57FA\u672C\u4FE1\u606F","li.showAdvAnnoMode a":"\u663E\u793A\u6807\u6CE8","li.showLocalizerLines a":"\u663E\u793A\u5B9A\u4F4D\u7EBF"}},"#helpInfo":{title:"\u663E\u793A\u7A0B\u5E8F\u5E2E\u52A9\u4FE1\u606F","a span.toolbar-text":"\u5E2E\u52A9",ul:{"li.help_manual a":"\u9605\u7247\u64CD\u4F5C\u8BF4\u660E","li.help_qrcode a":"\u6253\u5F00\u4E8C\u7EF4\u7801","li.help_about a":{title:"\u663E\u793A\u7A0B\u5E8F\u4FE1\u606F",text:"\u5173\u4E8E\u6B64\u7A0B\u5E8F"},"li.help_site a":{href:"http://www.weiyunyingxiang.com",title:"http://www.weiyunyingxiang.com",text:"\u516C\u53F8\u4ECB\u7ECD"},"li.help_weibo a":{href:"http://weibo.com/u/5607189020",title:"\u8BF7\u5173\u6CE8\u5FAE\u4FE1\u516C\u4F17\u53F7/\u5FAE\u535A:@\u5FAE\u4E91\u5F71\u50CF",text:"@\u5FAE\u4E91\u5F71\u50CF"},"li.help_email a":{href:"mailto://weiyunyingxiang@163.com?subject=DodoDICOM",title:"weiyunyingxiang@163.com",text:"\u90AE\u4EF6\u8054\u7CFB"}}},"#viewerToolbar>a.viewer3DMode":{title:"\u5207\u6362\u52303D MPR\u6D4F\u89C8\u6A21\u5F0F","span.toolbar-text":"\u4E09\u7EF4"},"#viewerToolbar>a.viewer2DMode":{title:"\u5207\u6362\u56DE2D \u539F\u59CB\u56FE\u50CF\u67E5\u770B\u6A21\u5F0F","span.toolbar-text":"\u4E8C\u7EF4"},"#changeViewport":{title:"\u6539\u53D8\u6574\u4E2A\u68C0\u67E5\u5185\u5E8F\u5217\u95F4\u7684\u56FE\u50CF\u5E03\u5C40","a span.toolbar-text":"\u5E8F\u5217"},"#changeLayout":{title:"\u6539\u53D8\u5E8F\u5217\u5185\u5404\u4E2A\u5F71\u50CF\u95F4\u7684\u56FE\u50CF\u5E03\u5C40","a span.toolbar-text":"\u5E03\u5C40"},"#imageOperations":{"#activeImageOperation":{title:"\u56FE\u50CF\u64CD\u4F5C","span.toolbar-text":"\u64CD\u4F5C"},ul:{"li.changeWindow a":"\u8C03\u7A97\u6A21\u5F0F","li.changeOffset a":"\u79FB\u52A8\u6A21\u5F0F","li.changeImageIndex a":"\u6D4F\u89C8\u6A21\u5F0F","li.viewer3DMode a":"\u4E09\u7EF4\u9605\u7247","li.viewer2DMode a":"\u4E8C\u7EF4\u9605\u7247","li.startConf a":"\u52A0\u5165\u4F1A\u8BCA","li.requestChair a":"\u7533\u8BF7\u4E3B\u6301","li.changeRotation a":"\u65CB\u8F6C","li.changeRevert a":"\u53D6\u53CD","li.changeZoomIn a":"\u653E\u5927","li.changeZoomOut a":"\u7F29\u5C0F","li.resetImageState a":"\u91CD\u7F6E\u56FE\u50CF","li.customWindowSetting a":"\u81EA\u5B9A\u4E49\u7A97\u4F4D"}},"#windowSettings":{title:"\u8C03\u6574\u4E3A\u9884\u8BBE\u7684\u7A97\u5BBD\u7A97\u4F4D\u8BBE\u7F6E","a.changeWindow":{title:"\u6309\u4E0B\u9F20\u6807\u79FB\u52A8\u65F6\u6539\u53D8\u7A97\u5BBD/\u7A97\u4F4D","span.toolbar-text":"\u8C03\u7A97"},"ul li.customWindowSetting a":"\u81EA\u5B9A\u4E49\u7A97\u4F4D"},"#viewerToolbar>a.changeOffset":{title:"\u6309\u4E0B\u9F20\u6807\u79FB\u52A8\u65F6\u79FB\u52A8\u56FE\u50CF","span.toolbar-text":"\u79FB\u52A8"},"#viewerToolbar>a.changeImageIndex":{title:"\u6309\u4E0B\u9F20\u6807\u79FB\u52A8\u65F6\u987A\u5E8F\u6D4F\u89C8\u5F71\u50CF","span.toolbar-text":"\u7FFB\u56FE"},"#viewerToolbar>a.changeRotation":{title:"\u987A\u65F6\u9488\u65CB\u8F6C90\u5EA6\u30023D MPR\u6D4F\u89C8\u6A21\u5F0F\u4E0B\uFF0C\u4F7F\u53F3\u4E0B\u89D2\u7A97\u53E3\u5F53\u524D\u64CD\u4F5C\u6A21\u5F0F\u5904\u4E8E\u65CB\u8F6C\u6A21\u5F0F\u3002","span.toolbar-text":"\u65CB\u8F6C"},"#viewerToolbar>a.changeRevert":{title:"\u5BF9\u989C\u8272\u503C\u53D6\u53CD","span.toolbar-text":"\u53CD\u7247"},"#viewerToolbar a.changeZoomIn":{title:"\u653E\u5927","span.toolbar-text":"\u653E\u5927"},"#viewerToolbar a.changeZoomOut":{title:"\u7F29\u5C0F","span.toolbar-text":"\u7F29\u5C0F"},"#viewerToolbar>a.resetImageState":{title:"\u91CD\u7F6E\u56FE\u50CF\u72B6\u6001","span.toolbar-text":"\u91CD\u7F6E"},"#viewerToolbar a.moveBack":{title:"\u663E\u793A\u4E0A\u4E00\u5F20\u5F71\u50CF","span.toolbar-text":"\u5411\u540E"},"#viewerToolbar a.moveNext":{title:"\u663E\u793A\u4E0B\u4E00\u5F20\u5F71\u50CF","span.toolbar-text":"\u5411\u524D"},"#playAsMovieGroup":{title:"\u987A\u5E8F\u64AD\u653E\u5F71\u50CF","a span.toolbar-text":"\u64AD\u653E",ul:{"li.playAsMovie a":"\u987A\u5E8F\u64AD\u653E","li.moveBack a":"\u4E0A\u4E00\u5F20","li.moveNext a":"\u4E0B\u4E00\u5F20","li.viewerplayspeed:has(i.default) a":"\u9ED8\u8BA4\u901F\u5EA6\u64AD\u653E","li.viewerplayspeed:has(i.fast) a":"\u5168\u901F\u64AD\u653E[60]","li.viewerplayspeed:has(i.normal) a":"\u5300\u901F\u64AD\u653E[30]","li.viewerplayspeed:has(i.slow) a":"\u6162\u901F\u64AD\u653E[15]","li.viewerplayspeed:has(i.tardiness) a":"\u7F13\u901F\u64AD\u653E[5 ]","li.viewerplayspeed:has(i.slide) a":"\u5E7B\u706F\u6A21\u5F0F[1 ]","li.viewerplaymodel:has(i.study) a":"\u64AD\u653E\u6240\u6709\u5F71\u50CF","li.viewerplaymodel:has(i.series) a":"\u64AD\u653E\u5F53\u524D\u5E8F\u5217"}},"#viewerToolbar a.moveBack":{title:"\u663E\u793A\u4E0A\u4E00\u5F20\u5F71\u50CF","span.toolbar-text":"\u5411\u540E"},"#viewerToolbar a.startConf":{title:"\u8FDB\u5165\u534F\u540C\u4F1A\u8BCA\u6A21\u5F0F","span.toolbar-text":"\u4F1A\u8BCA"},"#viewerToolbar a.requestChair":{title:"\u7533\u8BF7\u4E3B\u6301\u4F1A\u8BAE","span.toolbar-text":"\u4E3B\u6301"},"#addAnnotation":{title:"\u6DFB\u52A0\u6807\u6CE8\u4FE1\u606F","a span.toolbar-text":"\u6807\u6CE8",ul:{"li.arrowTextAnnno a":"\u7BAD\u5934\u6587\u5B57","li.lineLengthAnno a":"\u76F4\u7EBF\u8DDD\u79BB","li.angularMeasureAnno a":"\u89D2\u5EA6\u6D4B\u91CF","li.pixelValueAnno a":"CT\u6D4B\u91CF\u503C","li.ellipticalAnno a":"\u692D\u5706\u8303\u56F4\u6D4B\u91CF","li.rectangleAnno a":"\u77E9\u5F62\u8303\u56F4\u6D4B\u91CF","li.freehandAnno":{title:"\u8FDB\u5165/\u9000\u51FA\u52FE\u753B\u6A21\u5F0F\uFF0CESC\u952E\u9000\u51FA","a span":"\u4EFB\u610F\u5F62\u72B6\u52FE\u753B"},"li.removeSelectedAnno":{title:"DELETE\u952E",a:"\u5220\u9664\u76EE\u6807\u6807\u6CE8"},"li.removeAllAnno":{title:"CTRL+DELETE\u952E",a:"\u6E05\u9664\u56FE\u50CF\u6807\u6CE8"},"li.captureImage":{title:"P\u952E \u6216PrintScreen\u952E",a:"\u622A\u53D6\u5F53\u524D\u56FE\u50CF"}}},"#studyInfoWithRS":{title:"\u663E\u793A\u68C0\u67E5\u4FE1\u606F","a span.toolbar-text":"\u4FE1\u606F",ul:{"#showInfoModal":{title:"\u663E\u793A\u68C0\u67E5\u4FE1\u606F",a:"\u663E\u793A\u68C0\u67E5\u4FE1\u606F"},"li.dropdown-header:eq(0)":"------------\u5173\u8054\u68C0\u67E5------------"}},"#studyInfoWithoutRS":{title:"\u663E\u793A\u68C0\u67E5\u4FE1\u606F","span.toolbar-text":"\u4FE1\u606F"},"#infoModal":{"h4.modal-title":"\u5FAE\u4E91\u5F71\u50CF - Dodo DICOM HTML5 Viewer","div.modal-body":{html:'<p style="text-align: center;border-width: 0px;"><img id="logo_img" width="128" height="128" /></p><p>Dodo DICOM HTML5 Viewer\u662F\u5FAE\u4E91\u5F71\u50CF(<a href="http://www.weiyunyingxiang.com" target="_blank">http://www.weiyunyingxiang.com</a>)\u65D7\u4E0B\u65B0\u4E00\u4EE3\u7684\u4E92\u8054\u7F51\u67E5\u770B\u3001\u5171\u4EAB\u533B\u7597\u5F71\u50CF\u7684\u8F6F\u4EF6\u3002\u672C\u8F6F\u4EF6\u662F\u4E00\u4E2A\u5B8C\u5168\u57FA\u4E8EHTML5\u6807\u51C6\u6784\u5EFA\u7EAFWeb\u5E94\u7528\uFF0C\u652F\u6301PC\u3001\u5E73\u677F\u548C\u624B\u673A\u7B49\u652F\u6301HTML5\u7684\u8BBE\u5907\uFF0C\u652F\u6301\u5D4C\u5165\u5FAE\u535A\u548C\u5FAE\u4FE1\u7684\u6D4F\u89C8\u5668\u8BBF\u95EE\u3002</p><p>\u672C\u8F6F\u4EF6\u5728\u67B6\u6784\u4E0A\u5927\u91CF\u91C7\u7528\u4E91\u8BA1\u7B97\u3001\u4E91\u5B58\u50A8\u3001CDN\u7B49\u4E92\u8054\u7F51\u6280\u672F\uFF0C\u63D0\u4F9B\u6709\u635F\u548C\u65E0\u635F\u56FE\u50CF\u538B\u7F29\u548C\u52A0\u8F7D\u6280\u672F\u3002\u5728\u63D0\u4F9B\u5168\u529F\u80FD\u7684\u8BCA\u65AD\u7EA7\u522B\u7684\u533B\u7597\u5F71\u50CF\u67E5\u770B\u4EA7\u54C1\u7684\u57FA\u7840\u4E0A,\u652F\u63013D MPR\uFF0C\u4EE5\u5168\u65B0\u7684\u7B97\u6CD5\u63D0\u4F9B\u5FEB\u5230\u6781\u81F4\u7684\u54CD\u5E94\u901F\u5EA6\uFF0C\u4EE5Web\u7684\u65B9\u5F0F\u63D0\u4F9B\u684C\u9762\u5E94\u7528\u5F0F\u7684\u54CD\u5E94\u901F\u5EA6\u548C\u4F53\u9A8C\u3002<a href="<%=request.getContextPath() %>/help.html#readingimage" target="_blank" ><strong>\u5728\u7EBF\u9605\u7247\u64CD\u4F5C\u8BF4\u660E</strong></a></p><p>\u672C\u8F6F\u4EF6\u6B63\u5728\u5F00\u53D1\u4E2D\uFF0C\u6B22\u8FCE\u63D0\u4EA4\u4F60\u7684\u95EE\u9898\u548C\u5EFA\u8BAE\u3002<a href="http://freedap.duapp.com/freedap/form/3/9/SURVEY__add" target="_blank">\u70B9\u6B64\u63D0\u4EA4\u3002</a></p><p><font style="font-style: italic;font-size: -2;">V{0} build:{1}</font></p><p>\u66F4\u591A\u4FE1\u606F\u8BF7\u5173\u6CE8\u5FAE\u4FE1/\u65B0\u6D6A\u5FAE\u535A <strong><a href="http://weibo.com/u/5607189020" target="_blank">@\u5FAE\u4E91\u5F71\u50CF</a></strong>,\u6216\u53D1\u90AE\u4EF6\u5230<strong><a href="mailto://weiyunyingxiang@163.com" target="_blank">weiyunyingxiang@163.com</a></strong></p>'},"div.modal-footer button":"\u5173\u95ED"},"#descModal":{"h4.modal-title":"\u75C5\u5386\u63CF\u8FF0","div.modal-body p.qrdesc":"\u626B\u7801\u6253\u5F00\u6B64\u56FE\u50CF!","div.modal-footer button":"\u5173\u95ED"},"#textModal":{"h4.modal-title":"\u8F93\u5165\u6587\u5B57\u4FE1\u606F","div.modal-footer button":"\u5173\u95ED"},"#windowsettingModal":{"h4.modal-title":"\u81EA\u5B9A\u4E49\u7A97\u5BBD/\u7A97\u4F4D\u8BBE\u7F6E","div.modal-body":{"p:has(#textWindowWidthInput)":"\u7A97\u5BBD:","p:has(#textWindowLevelInput)":"\u7A97\u4F4D:"},"div.modal-footer button":"\u786E\u5B9A:"},"#workingProgressModal":{"h4.modal-title":"\u4E09\u7EF4\u91CD\u5EFA\u5B8C\u6210\u8FDB\u5EA6","div.modal-body":{"p:eq(0)":"\u5728\u6D4F\u89C8\u5668\u4E2D\u8FDB\u884C3\u7EF4\u91CD\u5EFA\u662F\u4E00\u9879\u6BD4\u8F83\u8D39\u65F6\u8D39\u529B\u7684\u4EFB\u52A1,\u6709\u635F\u538B\u7F29\u5C24\u5176\u8D39\u65F6,\u8BF7\u8010\u5FC3\u7B49\u5F85\u3002\u5BF9\u4E8E\u5185\u5B58\u6709\u9650\u7684\u79FB\u52A8\u8BBE\u5907\u6765\u8BF4\uFF0C\u91CD\u5EFA\u4EFB\u52A1\u53EF\u80FD\u4F1A\u56E0\u4E3A\u5185\u5B58\u8017\u5C3D\u800C\u7EC8\u6B62\u3002","p:eq(1) strong":"\u8BF7\u5728\u6027\u80FD\u8F83\u597D\u7684\u8BBE\u5907\u4E0A\u8FDB\u884C3\u7EF4\u91CD\u5EFA!"}}}};dodo.Lang.setLang("cn");dodo.Lang.langs.en={name:"English",BROWSER_ERROR:"You are using a outdated browser(IE5/6/7/8), please upgrade to IE9. \r\n IE11, Chrome, Firefox, safari is recommended.",REQUEST_ERROR:"Invalid request, please check request paramters or contact administrator.",CHANGE_COMPRESS:"Switch to {0} Mode?",AJAX_ERROR:"Data request error\uFF1A{0}",TOO_MANY_IMAGE_ERROR:"Only support {0} Viewports in Browser.",CACHING_CONFIRM_MSG:"Waiting for all image loaded to have the best experience.\r\nPress 'OK' to continue.",COMP_MODE:"Compatible Mode",SPEED_MODE:"Ultimate Mode",IMAGE_DESC:"Total {1} Images in {0} Series, Cached {2} Images.",THREED_START:"3D Processing, wait a moment...",THREED_UNSUPPORT_SERIES:"Selected Series cannot be used to 3D MPR processing.",THREED_UNSUPPORT_DEVICE:"Your device or browser cannot be used to 3D MPR processing. Upgrade to modern Browser.",THREED_X_NAME:"Coronal",THREED_Y_NAME:"Sagittal",THREED_Z_NAME:"Axial",THREED_MIP_NAME:"MIP",THREED_SSD_NAME:"SSD",THREED_VR_NAME:"Volume",THREED_TOO_BIG_SERIES:"Loading huge Images to 3D processing may lead to Browser crashed. \r\n Press 'OK' to continue.",DRAW_MODE_NAME:"Freehand Mode",CONF_START_MSG:"Joining to conference",CONF_DISCONNECTED_MSG:"Disconnected",CONF_USER_JOIN:"{0} is joining conference, there are {1} people, {2} is chairing",CONF_USER_LEFT:"{0} exit, there are {1} people, {2} is chairing",CONF_USER_CHAIR:"Now {0} is chairing",CONF_REQUEST_CHAIR:"{0} request to be the Chairman\uFF0Cplease confirm.",CONF_USER_SHOW:"Show Image{2} in Series{1}/Study{0}",annos:{dob:"BIRTH:",image:"IMAGE:",series:"SERIES:",sdate:"EXAM DATE:",columns:"COLUMNS:",rows:"/ROWS:",wl:"WL:",ww:"/WW:",scale:"SCALE:",sliceThickness:"THICKNESS:"},html:{"#imageSettings":{title:"Settings","a span.toolbar-text":"Sett.",ul:{"li.relativeMode a":"Fit to Viewport","li.absoluteMode a":"Fit to Image","li.positionSync a":"Synchronizing by Position","li.indexSync a":"Synchronizing by Slides","li.imageMode a":"Active Image","li.seriesMode a":"Images in Series","li.studyMode a":"Images in Study","li.smoothMode a":"Zoom Linear","li.rawMode a":"Zoom Default","li.lossyMode a":"Lossy","li.losslessMode a":"Lossless","li.showBaseAnnoMode a":"Display Overlay","li.showAdvAnnoMode a":"Display Annotations","li.showLocalizerLines a":"Cross Reference"}},"#helpInfo":{title:"Help","a span.toolbar-text":"Help",ul:{"li.help_manual a":"User Guide","li.help_qrcode a":"QR Code","li.help_about a":{title:"About this App",text:"About App"},"li.help_site a":{href:"http://www.weiyunyingxiang.com",title:"http://www.weiyunyingxiang.com",text:"About Us"},"li.help_weibo a":{href:"http://weibo.com/u/5607189020",title:"Watch @\u5FAE\u4E91\u5F71\u50CF",text:"@\u5FAE\u4E91\u5F71\u50CF"},"li.help_email a":{href:"mailto://weiyunyingxiang@163.com?subject=DodoDICOM",title:"weiyunyingxiang@163.com",text:"Email"}}},"#viewerToolbar>a.viewer3DMode":{title:"3D MPR Display(MPR,MIP,VR)","span.toolbar-text":"3D"},"#viewerToolbar>a.viewer2DMode":{title:"Back to 2D Mode","span.toolbar-text":"2D"},"#changeViewport":{title:"Change viewport's layouts for Series display","a span.toolbar-text":"View."},"#changeLayout":{title:"Change layouts for Images display","a span.toolbar-text":"Lay."},"#imageOperations":{"#activeImageOperation":{title:"Image Manipulation and Measurement","span.toolbar-text":"IMM"},ul:{"li.changeWindow a":"W/L","li.changeOffset a":"Pan","li.changeImageIndex a":"Scroll","li.viewer3DMode a":"3D","li.viewer2DMode a":"2D","li.startConf a":"Conference","li.requestChair a":"Chair","li.changeRotation a":"Rotate","li.changeRevert a":"Invert","li.changeZoomIn a":"Zoom In","li.changeZoomOut a":"Zoom Out","li.resetImageState a":"Reset","li.customWindowSetting a":"Set W/L"}},"#windowSettings":{title:"Preset Window Level/Window Width","a.changeWindow":{title:"Drag left button to adjust Window Level/Window Width","span.toolbar-text":"W/L"},"ul li.customWindowSetting a":"Set W/L"},"#viewerToolbar>a.changeOffset":{title:"Panning an Image","span.toolbar-text":"Pan"},"#viewerToolbar>a.changeImageIndex":{title:"Scrolling Through Images in a Series","span.toolbar-text":"Scro."},"#viewerToolbar>a.changeRotation":{title:"Flipping an Image Vertically. Only for lower-right Viewport in 3D MPR Mode","span.toolbar-text":"Flip"},"#viewerToolbar>a.changeRevert":{title:"Invert an Image","span.toolbar-text":"Inv."},"#viewerToolbar a.changeZoomIn":{title:"Zoom In","span.toolbar-text":"[+]"},"#viewerToolbar a.changeZoomOut":{title:"Zoom Out","span.toolbar-text":"[-]"},"#viewerToolbar>a.resetImageState":{title:"Reset","span.toolbar-text":"Reset"},"#viewerToolbar a.moveBack":{title:"Previous Image","span.toolbar-text":"Prev."},"#viewerToolbar a.moveNext":{title:"Next Image","span.toolbar-text":"Next"},"#playAsMovieGroup":{title:"Play/Stop","a span.toolbar-text":"Cine",ul:{"li.playAsMovie a":"Cine","li.moveBack a":"Previous","li.moveNext a":"Next","li.viewerplayspeed:has(i.default) a":"Default","li.viewerplayspeed:has(i.fast) a":"Very Fast[60fps]","li.viewerplayspeed:has(i.normal) a":"Fast     [30fps]","li.viewerplayspeed:has(i.slow) a":"Normal   [15fps]","li.viewerplayspeed:has(i.tardiness) a":"Slow     [ 5fps]","li.viewerplayspeed:has(i.slide) a":"Slide Mode","li.viewerplaymodel:has(i.study) a":"On Study","li.viewerplaymodel:has(i.series) a":"On Series"}},"#viewerToolbar a.startConf":{title:"Conf.","span.toolbar-text":"Conf."},"#viewerToolbar a.requestChair":{title:"Chairing","span.toolbar-text":"Chai."},"#addAnnotation":{title:"Annotate","a span.toolbar-text":"Anno.",ul:{"li.arrowTextAnnno a":"Arrow","li.lineLengthAnno a":"Distance","li.angularMeasureAnno a":"Angle","li.pixelValueAnno a":"CT Hounsfeld","li.ellipticalAnno a":"Elliptical","li.rectangleAnno a":"Rectangle","li.freehandAnno":{title:"Freehand\uFF0CFreehand by ESC","a span":"Freehand"},"li.removeSelectedAnno":{title:"Delete Annotation",a:"Delete"},"li.removeAllAnno":{title:"Clear Annotations by Ctrl+Del",a:"Clear"},"li.captureImage":{title:"Capture Image by 'P' or PrintScreen",a:"Capture Image"}}},"#studyInfoWithRS":{title:"Display Study Info","a span.toolbar-text":"Info",ul:{"#showInfoModal":{title:"Display Study Info",a:"Study Info"},"li.dropdown-header:eq(0)":"------------Referenced Study------------"}},"#studyInfoWithoutRS":{title:"Display Study Info","span.toolbar-text":"Info"},"#infoModal":{"h4.modal-title":"\u5FAE\u4E91\u5F71\u50CF--Awesome Cloud HTML5 DICOM Viewer","div.modal-body":{html:'<p style="text-align: center;border-width: 0px;"><img id="logo_img" width="128" height="128" /></p><p>The Dodo Cloud HTML5 DICOM Viewer is designed and developed by \u5FAE\u4E91\u5F71\u50CF(<a href="http://www.weiyunyingxiang.com" target="_blank">http://www.weiyunyingxiang.com</a>). It\'s a HTML5 featured web application, provides easy access to images and reports wherever Internet access is available.has the added advantages of a zero installation time, with no download of any software (web or product) to the user desktop, with zero administrative rights required on the user\u2019s device like PC, iOS, Android.</p><p>We try to leverage the best cloud computing technology like CDN, Object Storage, Server-less to make Healthcare IT evolved.<a href="<%=request.getContextPath() %>/help.html#readingimage" target="_blank" ><strong>User Guide</strong></a></p><p>We are continuously improving this software, happy to hear your voice <a href="http://freedap.duapp.com/freedap/form/3/9/SURVEY__add" target="_blank">send your feedback</a></p><p><font style="font-style: italic;font-size: -2;">V{0} build:{1}</font></p><p>Follow Wechat and Weibo <strong><a href="http://weibo.com/u/5607189020" target="_blank">@\u5FAE\u4E91\u5F71\u50CF</a></strong>,or email to <strong><a href="mailto://weiyunyingxiang@163.com" target="_blank">weiyunyingxiang@163.com</a></strong></p>'},"div.modal-footer button":"Close"},"#descModal":{"h4.modal-title":"Clinical Impression","div.modal-body p.qrdesc":"Share QR Code","div.modal-footer button":"Close"},"#textModal":{"h4.modal-title":"Input text","div.modal-footer button":"Close"},"#windowsettingModal":{"h4.modal-title":"Set W/L","div.modal-body":{"p:has(#textWindowWidthInput)":"WW:","p:has(#textWindowLevelInput)":"WL:"},"div.modal-footer button":"Confirm"},"#workingProgressModal":{"h4.modal-title":"3D Progressing","div.modal-body":{"p:eq(0)":"Be patient with 3D processing.","p:eq(1) strong":"Run it on better hardware to get best experience!"}}}};dodo.Lang.langs.tw={name:"\u7E41\u9AD4\u4E2D\u6587",BROWSER_ERROR:"\u672C\u8EDF\u4EF6\u57FA\u65BCHTML5\u6280\u8853\u5EFA\u8A2D\uFF0C\u4E0D\u652F\u6301IE5\\6\\7\\8\u7B49\u53E4\u8001\u700F\u89BD\u5668\u8A2A\u554F\u3002\r\n\u8ACB\u4F7F\u7528IE9\u4EE5\u4E0A\u700F\u89BD\u5668\u8A2A\u554F,\u63A8\u85A6\u4F7F\u7528IE11\u3001Chrome\u3001Firefox\u3001safri\u7B49\u700F\u89BD\u5668\u8A2A\u554F\u3002",REQUEST_ERROR:"\u7121\u6548\u7684\u6AA2\u67E5\u5F71\u50CF\u8ABF\u95B1\u8ACB\u6C42.\r\n\u8ACB\u6838\u67E5\u700F\u89BD\u5668\u7248\u672C\u662F\u5426\u662F\u652F\u6301\u7684\u7248\u672C,\u53CA\u8ABF\u95B1\u53C3\u6578\u662F\u5426\u6B63\u78BA\uFF01\r\n\u63A8\u85A6\u4F7F\u7528IE11\u3001Edge\u3001Chrome\u3001Firefox\u3001Safri\u7B49\u700F\u89BD\u5668\u8A2A\u554F\u3002",CHANGE_COMPRESS:"\u662F\u5426\u5207\u63DB{0}\u6A21\u5F0F\uFF1F",AJAX_ERROR:"\u6578\u64DA\u8ACB\u6C42\u51FA\u932F\uFF1A{0}",TOO_MANY_IMAGE_ERROR:"\u7531\u65BC\u700F\u89BD\u5668\u6027\u80FD\u9650\u5236\uFF0C\u5728\u5C4F\u5E55\u4E0A\u6700\u591A\u53EA\u5141\u8A31\u540C\u6642\u5B58\u5728{0}\u500B\u5F71\u50CF\u986F\u793A\u5340\u57DF",CACHING_CONFIRM_MSG:"\u5F71\u50CF\u6B63\u5728\u5F8C\u81FA\u52A0\u8F09\u4E2D\u3002\r\n\u73FE\u5728\u555F\u52D5\u64AD\u653E\u529F\u80FD\u53EF\u80FD\u5C0E\u81F4\u97FF\u61C9\u901F\u5EA6\u4E0D\u5920\u6D41\u66A2\uFF0C\u5F71\u50CF\u52A0\u8F09\u5B8C\u6210\u5F8C\u5C07\u7372\u5F97\u6D41\u66A2\u7684\u700F\u89BD\u901F\u5EA6\u3002\r\n\u662F\u5426\u7E7C\u7E8C\u555F\u52D5\u64AD\u653E\u529F\u80FD\uFF1F",COMP_MODE:"\u517C\u5BB9\u6A21\u5F0F",SPEED_MODE:"\u6975\u901F\u6A21\u5F0F",IMAGE_DESC:"\u5171 {0} \u500B\u5E8F\u5217\uFF0C{1} \u500B\u5F71\u50CF\uFF0C\u5DF2\u7DE9\u5B58 {2} \u500B\u5F71\u50CF\u3002",THREED_START:"\u6B63\u5728\u9032\u884C3\u7DAD\u91CD\u5EFA\uFF0C\u8ACB\u7A0D\u5019...",THREED_UNSUPPORT_SERIES:"\u7576\u524D\u9078\u4E2D\u7684\u5E8F\u5217\u4E0D\u652F\u63013D MPR\u91CD\u5EFA.",THREED_UNSUPPORT_DEVICE:"\u7576\u524D\u700F\u89BD\u5668\u6216\u8005\u8A2D\u5099\u4E0D\u652F\u63013D MPR\u91CD\u5EFA.\u9700\u8981IE11\u53CA\u6700\u65B0\u7684\u8C37\u6B4C\u548C\u706B\u72D0\u700F\u89BD\u5668\u3002",THREED_X_NAME:"\u51A0\u4F4D",THREED_Y_NAME:"\u77E2\u4F4D",THREED_Z_NAME:"\u8EF8\u4F4D",THREED_MIP_NAME:"MIP",THREED_SSD_NAME:"SSD",THREED_VR_NAME:"\u5BB9\u7A4D",THREED_TOO_BIG_SERIES:"\u7576\u524D\u9078\u4E2D\u7684\u5E8F\u5217\u592A\u5927\uFF0C\u7E7C\u7E8C\u9032\u884C3\u7DAD\u91CD\u5EFA\u53EF\u80FD\u5C0E\u81F4\u7A0B\u5E8F\u5D29\u6F70\u3002\u662F\u5426\u7E7C\u7E8C\uFF1F",DRAW_MODE_NAME:"\u52FE\u756B\u6A21\u5F0F",CONF_START_MSG:"\u6B63\u5728\u9023\u63A5\u5F71\u50CF\u6703\u8A3A\u6703\u8B70",CONF_DISCONNECTED_MSG:"\u5DF2\u65B7\u958B\u5F71\u50CF\u6703\u8A3A\u6703\u8B70",CONF_USER_JOIN:"{0}\u5DF2\u52A0\u5165\u7576\u524D\u6703\u8B70,\u7576\u524D\u5171{1}\u4EBA,\u6703\u8B70\u4E3B\u6301\u70BA{2}",CONF_USER_LEFT:"{0}\u5DF2\u96E2\u958B\u7576\u524D\u6703\u8B70,\u7576\u524D\u5171{1}\u4EBA,\u6703\u8B70\u4E3B\u6301\u70BA{2}",CONF_USER_CHAIR:"\u7576\u524D\u6703\u8B70\u4E3B\u6301\u4EBA\u8B8A\u66F4\u70BA{0}",CONF_REQUEST_CHAIR:"{0}\u7533\u8ACB\u8B8A\u66F4\u70BA\u6703\u8B70\u4E3B\u6301\u4EBA\uFF0C\u9EDE\u3010\u78BA\u5B9A\u3011\u6309\u9215\u540C\u610F",CONF_USER_SHOW:"\u9078\u64C7\u986F\u793A\u6AA2\u67E5{0}\u7684\u5E8F\u5217{1}\u5716\u50CF{2}",annos:{dob:"BIRTH:",image:"IMAGE:",series:"SERIES:",sdate:"EXAM DATE:",columns:"COLUMNS:",rows:"/ROWS:",wl:"WL:",ww:"/WW:",scale:"SCALE:",sliceThickness:"THICKNESS:"},html:{"#imageSettings":{title:"\u4FEE\u6539\u8A2D\u7F6E\u4FE1\u606F","a span.toolbar-text":"\u8A2D\u7F6E",ul:{"li.relativeMode a":"\u9069\u61C9\u7A97\u53E3\u5927\u5C0F","li.absoluteMode a":"\u9069\u61C9\u5716\u50CF\u5927\u5C0F","li.positionSync a":"\u4F4D\u7F6E\u540C\u6B65\u7FFB\u5716","li.indexSync a":"\u7D22\u5F15\u540C\u6B65\u7FFB\u5716","li.imageMode a":"\u64CD\u4F5C\u5716\u50CF","li.seriesMode a":"\u64CD\u4F5C\u5E8F\u5217","li.studyMode a":"\u64CD\u4F5C\u6AA2\u67E5","li.smoothMode a":"\u5E73\u6ED1\u7E2E\u653E","li.rawMode a":"\u539F\u59CB\u7E2E\u653E","li.lossyMode a":"\u6709\u640D\u58D3\u7E2E","li.losslessMode a":"\u7121\u640D\u58D3\u7E2E","li.showBaseAnnoMode a":"\u986F\u793A\u57FA\u672C\u4FE1\u606F","li.showAdvAnnoMode a":"\u986F\u793A\u6A19\u8A3B","li.showLocalizerLines a":"\u986F\u793A\u5B9A\u4F4D\u7DDA"}},"#helpInfo":{title:"\u986F\u793A\u7A0B\u5E8F\u5E6B\u52A9\u4FE1\u606F","a span.toolbar-text":"\u5E6B\u52A9",ul:{"li.help_manual a":"\u95B1\u7247\u64CD\u4F5C\u8AAA\u660E","li.help_qrcode a":"\u6253\u958B\u4E8C\u7DAD\u78BC","li.help_about a":{title:"\u986F\u793A\u7A0B\u5E8F\u4FE1\u606F",text:"\u95DC\u65BC\u6B64\u7A0B\u5E8F"},"li.help_site a":{href:"http://www.weiyunyingxiang.com",title:"http://www.weiyunyingxiang.com",text:"\u516C\u53F8\u4ECB\u7D39"},"li.help_weibo a":{href:"http://weibo.com/u/5607189020",title:"\u8ACB\u95DC\u8A3B\u5FAE\u4FE1\u516C\u773E\u865F/\u5FAE\u535A:@\u5FAE\u96F2\u5F71\u50CF",text:"@\u5FAE\u96F2\u5F71\u50CF"},"li.help_email a":{href:"mailto://weiyunyingxiang@163.com?subject=DodoDICOM",title:"weiyunyingxiang@163.com",text:"\u90F5\u4EF6\u806F\u7CFB"}}},"#viewerToolbar>a.viewer3DMode":{title:"\u5207\u63DB\u52303D MPR\u700F\u89BD\u6A21\u5F0F","span.toolbar-text":"\u4E09\u7DAD"},"#viewerToolbar>a.viewer2DMode":{title:"\u5207\u63DB\u56DE2D \u539F\u59CB\u5716\u50CF\u67E5\u770B\u6A21\u5F0F","span.toolbar-text":"\u4E8C\u7DAD"},"#changeViewport":{title:"\u6539\u8B8A\u6574\u500B\u6AA2\u67E5\u5167\u5E8F\u5217\u9593\u7684\u5716\u50CF\u5E03\u5C40","a span.toolbar-text":"\u5E8F\u5217"},"#changeLayout":{title:"\u6539\u8B8A\u5E8F\u5217\u5167\u5404\u500B\u5F71\u50CF\u9593\u7684\u5716\u50CF\u5E03\u5C40","a span.toolbar-text":"\u5E03\u5C40"},"#imageOperations":{"#activeImageOperation":{title:"\u5716\u50CF\u64CD\u4F5C","span.toolbar-text":"\u64CD\u4F5C"},ul:{"li.changeWindow a":"\u8ABF\u7A97\u6A21\u5F0F","li.changeOffset a":"\u79FB\u52D5\u6A21\u5F0F","li.changeImageIndex a":"\u700F\u89BD\u6A21\u5F0F","li.viewer3DMode a":"\u4E09\u7DAD\u95B1\u7247","li.viewer2DMode a":"\u4E8C\u7DAD\u95B1\u7247","li.startConf a":"\u52A0\u5165\u6703\u8A3A","li.requestChair a":"\u7533\u8ACB\u4E3B\u6301","li.changeRotation a":"\u65CB\u8F49","li.changeRevert a":"\u53D6\u53CD","li.changeZoomIn a":"\u653E\u5927","li.changeZoomOut a":"\u7E2E\u5C0F","li.resetImageState a":"\u91CD\u7F6E\u5716\u50CF","li.customWindowSetting a":"\u81EA\u5B9A\u7FA9\u7A97\u4F4D"}},"#windowSettings":{title:"\u8ABF\u6574\u70BA\u9810\u8A2D\u7684\u7A97\u5BEC\u7A97\u4F4D\u8A2D\u7F6E","a.changeWindow":{title:"\u6309\u4E0B\u9F20\u6A19\u79FB\u52D5\u6642\u6539\u8B8A\u7A97\u5BEC/\u7A97\u4F4D","span.toolbar-text":"\u8ABF\u7A97"},"ul li.customWindowSetting a":"\u81EA\u5B9A\u7FA9\u7A97\u4F4D"},"#viewerToolbar>a.changeOffset":{title:"\u6309\u4E0B\u9F20\u6A19\u79FB\u52D5\u6642\u79FB\u52D5\u5716\u50CF","span.toolbar-text":"\u79FB\u52D5"},"#viewerToolbar>a.changeImageIndex":{title:"\u6309\u4E0B\u9F20\u6A19\u79FB\u52D5\u6642\u9806\u5E8F\u700F\u89BD\u5F71\u50CF","span.toolbar-text":"\u7FFB\u5716"},"#viewerToolbar>a.changeRotation":{title:"\u9806\u6642\u91DD\u65CB\u8F4990\u5EA6\u30023D MPR\u700F\u89BD\u6A21\u5F0F\u4E0B\uFF0C\u4F7F\u53F3\u4E0B\u89D2\u7A97\u53E3\u7576\u524D\u64CD\u4F5C\u6A21\u5F0F\u8655\u65BC\u65CB\u8F49\u6A21\u5F0F\u3002","span.toolbar-text":"\u65CB\u8F49"},"#viewerToolbar>a.changeRevert":{title:"\u5C0D\u984F\u8272\u503C\u53D6\u53CD","span.toolbar-text":"\u53CD\u7247"},"#viewerToolbar a.changeZoomIn":{title:"\u653E\u5927","span.toolbar-text":"\u653E\u5927"},"#viewerToolbar a.changeZoomOut":{title:"\u7E2E\u5C0F","span.toolbar-text":"\u7E2E\u5C0F"},"#viewerToolbar>a.resetImageState":{title:"\u91CD\u7F6E\u5716\u50CF\u72C0\u614B","span.toolbar-text":"\u91CD\u7F6E"},"#viewerToolbar a.moveBack":{title:"\u986F\u793A\u4E0A\u58F9\u5F35\u5F71\u50CF","span.toolbar-text":"\u5411\u5F8C"},"#viewerToolbar a.moveNext":{title:"\u986F\u793A\u4E0B\u58F9\u5F35\u5F71\u50CF","span.toolbar-text":"\u5411\u524D"},"#playAsMovieGroup":{title:"\u9806\u5E8F\u64AD\u653E\u5F71\u50CF","a span.toolbar-text":"\u64AD\u653E",ul:{"li.playAsMovie a":"\u9806\u5E8F\u64AD\u653E","li.moveBack a":"\u4E0A\u58F9\u5F35","li.moveNext a":"\u4E0B\u58F9\u5F35","li.viewerplayspeed:has(i.default) a":"\u9ED8\u8A8D\u901F\u5EA6\u64AD\u653E","li.viewerplayspeed:has(i.fast) a":"\u5168\u901F\u64AD\u653E[60]","li.viewerplayspeed:has(i.normal) a":"\u52FB\u901F\u64AD\u653E[30]","li.viewerplayspeed:has(i.slow) a":"\u6162\u901F\u64AD\u653E[15]","li.viewerplayspeed:has(i.tardiness) a":"\u7DE9\u901F\u64AD\u653E[5 ]","li.viewerplayspeed:has(i.slide) a":"\u5E7B\u71C8\u6A21\u5F0F[1 ]","li.viewerplaymodel:has(i.study) a":"\u64AD\u653E\u6240\u6709\u5F71\u50CF","li.viewerplaymodel:has(i.series) a":"\u64AD\u653E\u7576\u524D\u5E8F\u5217"}},"#viewerToolbar a.moveBack":{title:"\u986F\u793A\u4E0A\u58F9\u5F35\u5F71\u50CF","span.toolbar-text":"\u5411\u5F8C"},"#viewerToolbar a.startConf":{title:"\u9032\u5165\u5354\u540C\u6703\u8A3A\u6A21\u5F0F","span.toolbar-text":"\u6703\u8A3A"},"#viewerToolbar a.requestChair":{title:"\u7533\u8ACB\u4E3B\u6301\u6703\u8B70","span.toolbar-text":"\u4E3B\u6301"},"#addAnnotation":{title:"\u6DFB\u52A0\u6A19\u8A3B\u4FE1\u606F","a span.toolbar-text":"\u6A19\u8A3B",ul:{"li.arrowTextAnnno a":"\u7BAD\u982D\u6587\u5B57","li.lineLengthAnno a":"\u76F4\u7DDA\u8DDD\u96E2","li.angularMeasureAnno a":"\u89D2\u5EA6\u6E2C\u91CF","li.pixelValueAnno a":"CT\u6E2C\u91CF\u503C","li.ellipticalAnno a":"\u6A62\u5713\u7BC4\u570D\u6E2C\u91CF","li.rectangleAnno a":"\u77E9\u5F62\u7BC4\u570D\u6E2C\u91CF","li.freehandAnno":{title:"\u9032\u5165/\u9000\u51FA\u52FE\u756B\u6A21\u5F0F\uFF0CESC\u9375\u9000\u51FA","a span":"\u4EFB\u610F\u5F62\u72C0\u52FE\u756B"},"li.removeSelectedAnno":{title:"DELETE\u9375",a:"\u522A\u9664\u76EE\u6A19\u6A19\u8A3B"},"li.removeAllAnno":{title:"CTRL+DELETE\u9375",a:"\u6E05\u9664\u5716\u50CF\u6A19\u8A3B"},"li.captureImage":{title:"P\u9375 \u6216PrintScreen\u9375",a:"\u622A\u53D6\u7576\u524D\u5716\u50CF"}}},"#studyInfoWithRS":{title:"\u986F\u793A\u6AA2\u67E5\u4FE1\u606F","a span.toolbar-text":"\u4FE1\u606F",ul:{"#showInfoModal":{title:"\u986F\u793A\u6AA2\u67E5\u4FE1\u606F",a:"\u986F\u793A\u6AA2\u67E5\u4FE1\u606F"},"li.dropdown-header:eq(0)":"------------\u95DC\u806F\u6AA2\u67E5------------"}},"#studyInfoWithoutRS":{title:"\u986F\u793A\u6AA2\u67E5\u4FE1\u606F","span.toolbar-text":"\u4FE1\u606F"},"#infoModal":{"h4.modal-title":"\u5FAE\u96F2\u5F71\u50CF - Dodo DICOM HTML5 Viewer","div.modal-body":{html:'<p style="text-align: center;border-width: 0px;"><img id="logo_img" width="128" height="128" /></p><p>Dodo DICOM HTML5 Viewer\u662F\u5FAE\u96F2\u5F71\u50CF(<a href="http://www.weiyunyingxiang.com" target="_blank">http://www.weiyunyingxiang.com</a>)\u65D7\u4E0B\u65B0\u58F9\u4EE3\u7684\u4E92\u806F\u7DB2\u67E5\u770B\u3001\u5171\u4EAB\u91AB\u7642\u5F71\u50CF\u7684\u8EDF\u4EF6\u3002\u672C\u8EDF\u4EF6\u662F\u58F9\u500B\u5B8C\u5168\u57FA\u65BCHTML5\u6A19\u6E96\u69CB\u5EFA\u7D14Web\u61C9\u7528\uFF0C\u652F\u6301PC\u3001\u5E73\u677F\u548C\u624B\u6A5F\u7B49\u652F\u6301HTML5\u7684\u8A2D\u5099\uFF0C\u652F\u6301\u5D4C\u5165\u5FAE\u535A\u548C\u5FAE\u4FE1\u7684\u700F\u89BD\u5668\u8A2A\u554F\u3002</p><p>\u672C\u8EDF\u4EF6\u5728\u67B6\u69CB\u4E0A\u5927\u91CF\u91C7\u7528\u96F2\u8A08\u7B97\u3001\u96F2\u5B58\u5132\u3001CDN\u7B49\u4E92\u806F\u7DB2\u6280\u8853\uFF0C\u63D0\u4F9B\u6709\u640D\u548C\u7121\u640D\u5716\u50CF\u58D3\u7E2E\u548C\u52A0\u8F09\u6280\u8853\u3002\u5728\u63D0\u4F9B\u5168\u529F\u80FD\u7684\u8A3A\u65B7\u7D1A\u5225\u7684\u91AB\u7642\u5F71\u50CF\u67E5\u770B\u7522\u54C1\u7684\u57FA\u790E\u4E0A,\u652F\u63013D MPR\uFF0C\u4EE5\u5168\u65B0\u7684\u7B97\u6CD5\u63D0\u4F9B\u5FEB\u5230\u6975\u81F4\u7684\u97FF\u61C9\u901F\u5EA6\uFF0C\u4EE5Web\u7684\u65B9\u5F0F\u63D0\u4F9B\u684C\u9762\u61C9\u7528\u5F0F\u7684\u97FF\u61C9\u901F\u5EA6\u548C\u9AD4\u9A57\u3002<a href="<%=request.getContextPath() %>/help.html#readingimage" target="_blank" ><strong>\u5728\u7DDA\u95B1\u7247\u64CD\u4F5C\u8AAA\u660E</strong></a></p><p>\u672C\u8EDF\u4EF6\u6B63\u5728\u958B\u767C\u4E2D\uFF0C\u6B61\u8FCE\u63D0\u4EA4\u59B3\u7684\u554F\u984C\u548C\u5EFA\u8B70\u3002<a href="http://freedap.duapp.com/freedap/form/3/9/SURVEY__add" target="_blank">\u9EDE\u6B64\u63D0\u4EA4\u3002</a></p><p><font style="font-style: italic;font-size: -2;">V{0} build:{1}</font></p><p>\u66F4\u591A\u4FE1\u606F\u8ACB\u95DC\u8A3B\u5FAE\u4FE1/\u65B0\u6D6A\u5FAE\u535A <strong><a href="http://weibo.com/u/5607189020" target="_blank">@\u5FAE\u96F2\u5F71\u50CF</a></strong>,\u6216\u767C\u90F5\u4EF6\u5230<strong><a href="mailto://weiyunyingxiang@163.com" target="_blank">weiyunyingxiang@163.com</a></strong></p>'},"div.modal-footer button":"\u95DC\u9589"},"#descModal":{"h4.modal-title":"\u75C5\u6B77\u63CF\u8FF0","div.modal-body p.qrdesc":"\u6383\u78BC\u6253\u958B\u6B64\u5716\u50CF!","div.modal-footer button":"\u95DC\u9589"},"#textModal":{"h4.modal-title":"\u8F38\u5165\u6587\u5B57\u4FE1\u606F","div.modal-footer button":"\u95DC\u9589"},"#windowsettingModal":{"h4.modal-title":"\u81EA\u5B9A\u7FA9\u7A97\u5BEC/\u7A97\u4F4D\u8A2D\u7F6E","div.modal-body":{"p:has(#textWindowWidthInput)":"\u7A97\u5BEC:","p:has(#textWindowLevelInput)":"\u7A97\u4F4D:"},"div.modal-footer button":"\u78BA\u5B9A:"},"#workingProgressModal":{"h4.modal-title":"\u4E09\u7DAD\u91CD\u5EFA\u5B8C\u6210\u9032\u5EA6","div.modal-body":{"p:eq(0)":"\u5728\u700F\u89BD\u5668\u4E2D\u9032\u884C3\u7DAD\u91CD\u5EFA\u662F\u58F9\u9805\u6BD4\u8F03\u8CBB\u6642\u8CBB\u529B\u7684\u4EFB\u52D9,\u6709\u640D\u58D3\u7E2E\u5C24\u5176\u8CBB\u6642,\u8ACB\u8010\u5FC3\u7B49\u5F85\u3002\u5C0D\u65BC\u5167\u5B58\u6709\u9650\u7684\u79FB\u52D5\u8A2D\u5099\u4F86\u8AAA\uFF0C\u91CD\u5EFA\u4EFB\u52D9\u53EF\u80FD\u6703\u56E0\u70BA\u5167\u5B58\u8017\u76E1\u800C\u7D42\u6B62\u3002","p:eq(1) strong":"\u8ACB\u5728\u6027\u80FD\u8F03\u597D\u7684\u8A2D\u5099\u4E0A\u9032\u884C3\u7DAD\u91CD\u5EFA!"}}}};dodo.Config=(function(){var h=dodo.decode;var g=h("%-%0&$&$&*");var b=h("%-%0&$&$%-%&&$&$");var f=h("'%'0'%'0&0'&()(%'&'/($'*'0'/");var c=h("'%'0'%'0&0'$'\"'-'-'#'\"'$',($");var d=h("')'0($(%");var e=h("(&($'&(#%\"'('&'/(%");var a={values:{layouts:["1X1","1X2","2X1","2X2","1X3","3X1","2X3","3X2","3X3"],windowSettings:["Chest","40/350","Abdomen","40/350","Lung","-600/1500","Bone","480/2500","Head","90/350","Brain","40/80"]},parseAndGetRequest:function(){var k=this.determineLanguage();if(k){dodo.Lang.setLang(k)}this.applyAnnoCreator();var j=dodo.UI;var i=dodo.apply(dodo.request,{request:this.getRequestStoreUid(),lossless:this.isLossless(),rsuid:this.getRsuid(),jsonUrlBase:this.getConfigValue("jsonUrlBase",undefined),imageUrlBase:this.getConfigValue("imageUrlBase",undefined),qrcodeUrl:this.getParamConfigValue("qu","qrcodeUrl",undefined),embedViewerUrl:this.getConfigValue("embedViewerUrl",undefined),downloadThreadCount:this.getDownloadThread(),confServerUrl:this.getConfigValue("confServerUrl",undefined),confUserName:this.getConfigValue("confUserName",undefined),confId:this.getConfigValue("confId",undefined),mfhost:this.getConfigValue("mfhost",undefined),enablePostMessage:this.getConfigValue("enablePostMessage",undefined),documentTitle:this.getConfigValue("documentTitle",undefined)});if(this.values.errorMessage){dodo.currentErrorMessage=this.values.errorMessage;j.initializeEvent=this.fireEvent=j.requestError;return i}if((!i.request)||(!i.jsonUrlBase)||(!i.imageUrlBase)){j.initializeEvent=this.fireEvent=j.requestError;return i}if(dodo.mode!="embed"&&(this.values[d]||this.values[e])){var l=document.location.hostname||document.location.host;if(!(this.values[d]==l||navigator.userAgent.indexOf(this.values[e])==0)){j.initializeEvent=this.fireEvent=j.requestError;return i}}return i},getRequestStoreUid:function(){if(dodo.request&&dodo.request.request){return dodo.request.request}else{if(this.values.request){return this.values.request}}dodo.UI.requestError()},isLossless:function(){var i=document.location.search;if(i&&i.indexOf("?"+b)==0){return true}else{if(i&&i.indexOf("?"+g)==0){return false}}if(dodo.request&&dodo.request.lossless!==undefined){return dodo.request.lossless}if(this.values.lossless!=undefined){return this.values.lossless}return false},getRsuid:function(){var m=dodo.getParam("rsuid");if(m&&m.length>0){var j=[];var l=m.split("-");for(var k=0;k<l.length;k++){if(l[k]&&l[k].length>0){request.rsuid.push(l[k])}}return j}if(dodo.request&&dodo.request.rsuid){return dodo.request.rsuid}if(this.values.rsuid){return this.values.rsuid}return[]},getConfigValue:function(j,i){if(dodo.request&&dodo.request[j]!==undefined){return dodo.request[j]}if(this.values[j]!==undefined){return this.values[j]}return i},getParamConfigValue:function(j,k,i){var l=dodo.getParam(j);if(l!==undefined&&l!==null){return l}return dodo.Config.getConfigValue(k,i)},getDownloadThread:function(){if(dodo.isMobile||dodo.isSafari){return 1}if(dodo.request&&dodo.request.downloadThreadCount){return dodo.request.downloadThreadCount}else{if(this.values.downloadThreadCount){return this.values.downloadThreadCount}}return 5},applyAnnoCreator:function(){var j=dodo.Pictorial.prototype;j.createSimpleAnnotations=j.createAnnotations;function i(n){var m={nl:dodo.EMPTY_FN,empty:dodo.EMPTY_FN,sl:j.createSimpleAnnotations,simple:j.createSimpleAnnotations,fl:j.createFullAnnotations,full:j.createFullAnnotations};if(typeof(n)=="function"){j.createAnnotations=n}else{var l=m[n];if(l){j.createAnnotations=l}}}var k=dodo.getParam("ao");if(k&&k.length>0){i(k)}else{if(dodo.request&&dodo.request.anno){i(dodo.request.anno)}else{if(this.values.anno){i(this.values.anno)}}}},determineLanguage:function(){var j=dodo.getParam("an");if(j&&j.length>0){return j}if(dodo.request&&dodo.request.lang){return dodo.request.lang}var i=navigator.language||navigator.userLanguage||navigator.browserLanguage||navigator.systemLanguage;if(i&&i.length>0){i=i.toLowerCase();if(i.indexOf("tw")>=0){return"tw"}if(i.indexOf("zh")>=0||i.indexOf("cn")>=0){return"cn"}if(dodo.Lang.langs.en){return"en"}}return"cn"},extendConfig:function(){var i=window[f];if(i&&typeof(i)=="string"){i=JSON.parse(h(i))}if(i&&typeof(i)=="object"){dodo.apply(this.values,i)}var j=window[c];if(j&&typeof(j)=="object"){dodo.apply(this.values,j)}},fireEvent:function(j,k){try{if(dodo.request&&dodo.request.enablePostMessage!==false){dodo.Message.sendNotify({notify:j})}var i=dodo.Config.values[j];if(i&&typeof(i)=="function"){return i.call(dodo,k)}}catch(l){dodo.log(j+" error "+l)}}};a.extendConfig();return a})();dodo.Image=(function(){var b=dodo.decode;var c=b("%-%0&$&$%-%&&$&$");var f=b("($(%(&'%(*");var d=b("($'&(#'*'&($");var e={src:"src",rows:"rows",columns:"columns",bitsStored:"bitsStored",windowCenter:"windowCenter",windowWidth:"windowWidth",rescaleIntercept:"rescaleIntercept",rescaleSlop:"rescaleSlop",photometric:"photometricInterpretation",rotation:"rotation",revert:"revert",scale:"scale",offset:"offset",compress:"compress",moveModel:"moveModel",name:"name",seriesNumber:"seriesNumber",instanceNumber:"instanceNumber",pixelSpacing:"pixelSpacing",imageOrientation:"imageOrientation",sc:"sc",ft:"fileType",annos:"annotations",lcm:"lcm",ipp:"imagePositionPatient",st:"sliceThickness",rotationX:"rotationX",rotationY:"rotationY",fps:"fps",hb:"highBit"};var a={};a[e.rotation]=0;a[e.revert]=false;a[e.scale]=1;a[e.compress]=c;a[e.offset]={x:0,y:0};dodo.option=a;var g=dodo.createCanvas();g.width=g.height=1;var i=g.getContext("2d");function h(l,n,k,j){if(l[e.rescaleSlop]===0){l[e.rescaleSlop]=1}if(l.virtual===true){this.virtual=true;this.isDirect=l.isDirect;this.drawImage=l.drawImage;if(l.getPixelValue){this.getPixelValue=l.getPixelValue}}else{if(l.rsuid){this.rs=true}}var m=l[[e.windowCenter]];var o=l[[e.windowWidth]];if((!m)||(!o)){l[[e.windowWidth]]=256;l[[e.windowCenter]]=128}else{if((-10<m&&m<10)&&(-10<o&&o<10)){l[[e.windowWidth]]=1000;l[[e.windowCenter]]=-500}}h.superClass.call(this,k,l);this.state=dodo.apply({},n||{});if(j){this.addCallback(j)}this.comsumerPictorials=[];this.maxImageWidth=this.imageWidth=l[e.columns];this.maxImageHeight=this.imageHeight=l[e.rows];this.maxPowerWidth=this.powerWidth=dodo.getNearPower(this.maxImageWidth);this.maxPowerHeight=this.powerHeight=dodo.getNearPower(this.maxImageHeight);var p=this.option[e.sc];if(p&&p>0){this.multiple=Math.sqrt(p)}this.imageLoading=k.createImageLoading(this)}dodo.extend(h,dodo.Object,{showInImageSize:false,imageOpMode:"series",startLoading:function(){var j=this.imageLoading;if((!j.isLoaded())||j.hasError()){j.start()}},getProperty:function(l,j){var k=dodo.getValue(this.getState(),l);if(dodo.isEmpty(k)){k=this.getOption(l,j)}if(dodo.isFunction(k)){k=k()}return k},imageLoadedHandler:function(){var j=this.imageLoading.getImageSize();this.imageWidth=j.actualWidth;this.imageHeight=j.actualHeight;this.powerWidth=j.width;this.powerHeight=j.height;this.fireDataChanged();if(this.callback){this.callback()}},hasPixel:function(){if(this.virtual===true){return true}return this.imageLoading.isLoaded()},hasError:function(){return this.imageLoading.hasError()},isLoadComplete:function(){if(this.virtual===true){return true}return this.imageLoading.isLoadComplete()},isLoading:function(){return this.imageLoading.isLoading()},getPixelDataElement:function(j){return this.imageLoading.getPixelDataElement(j)},getDisplayBounds:function(q,j){var m=this.getRotation();var k=this.getScale();var n=(m%180==0)?{width:this.imageWidth,height:this.imageHeight}:{width:this.imageHeight,height:this.imageWidth};var p=1;if(this.showInImageSize!==true){var o=n.width/q.width;var r=n.height/q.height;p=Math.max(r,o)}var l=this.imageLoading;if(l.isLoaded()&&(!l.isLoadComplete())&&(p/k)<1){l.next()}return{x:(q.width-(n.width/p))/2,y:(q.height-(n.height/p))/2,width:n.width/p,height:n.height/p,scale:1/p}},addComsumer:function(j){this.comsumerPictorials.push(j)},removeComsumer:function(j){this.comsumerPictorials.remove(j)},fireDataChanged:function(){var k=this.comsumerPictorials.length;for(var j=0;j<k;j++){this.comsumerPictorials[j].imageDataChanged(this)}},fireImageStateChanged:function(n){var m=this.comsumerPictorials.length;if(m<0){return}var k=this.imageOpMode;var r=this.comsumerPictorials;if(r.length>0&&k==d){var j=r[0].getViewPort();for(var l=0;l<m;l++){var q=this.comsumerPictorials[l];var o=(j!==q.parent)?q.parent:q;o.refresh()}}else{if(r.length>0&&k==f){var j=r[0].getViewPort();j.refresh()}else{this.fireDataChanged()}}this.sendConfData(false)},getRotation:function(){return this.getProperty(e.rotation,0)},getScale:function(){return this.getProperty(e.scale,1)},getOffset:function(){var j=this.getState().offset;return(j&&j.x)?j:{x:0,y:0}},clearAnnotations:function(){var n=this.getAnnotations();if(n){for(var l=0;l<n.length;l++){var m=this.comsumerPictorials.length;for(var k=0;k<m;k++){n[l].destroy(this,this.comsumerPictorials[k])}}delete this.state[e.annos];this.fireDataChanged();this.sendConfData(true)}},removeSelectedAnnotation:function(p){var o=this.getAnnotations();var m=p.render.fCanvas.getActiveObject();if(o&&m){var n=this.comsumerPictorials.length;var l=m.annotation;for(var k=0;k<n;k++){l.destroy(this,this.comsumerPictorials[k])}o.remove(l);this.fireDataChanged();this.sendConfData(true)}},clearState:function(){var n=this.getAnnotations();if(n){for(var l=0;l<n.length;l++){var m=this.comsumerPictorials.length;for(var k=0;k<m;k++){n[l].destroy(this,this.comsumerPictorials[k])}}}var o=this.getState()||{};var r=[];for(var q in o){r.push(q)}for(var l=0;l<r.length;l++){delete o[r[l]]}if(o!==this.state){delete this.state[e.annos];this.sendConfData(true)}this.fireImageStateChanged()},rotate:function(l){var k=e.rotation;var j=this.getProperty(k,0)+l;if(j>=360){j=j%360}this.getState()[k]=j;this.fireImageStateChanged()},zoom:function(j){var l=e.scale;var k=this.getProperty(l,1)+j;if(k>10){k=10}if(k<0.01){k=0.01}this.getState()[l]=k;this.fireImageStateChanged()},revert:function(){var j=e.revert;var k=this.getState()[j]=!this.getProperty(j,false);this.fireImageStateChanged();return k},setWindow:function(l,j){var k=this.getState();k[e.windowCenter]=Math.round(l);k[e.windowWidth]=Math.round(j);this.fireImageStateChanged()},callback:function(){var k=this.callbacks;if(k){for(var j=0;j<k.length;j++){k[j].call(this)}delete this.callbacks}},addCallback:function(j){if(j){if(!this.callbacks){this.callbacks=[]}this.callbacks.push(j)}},getState:function(){var j=this.imageOpMode;if(j==f){return this.option.study.state}else{if(j==d){return this.option.series.state}else{return this.state}}},getAnnotations:function(){return this.state[e.annos]},addAnnotation:function(j){var k=this.state[e.annos]||[];k.push(j);this.state[e.annos]=k;this.fireDataChanged();this.sendConfData(true)},clientToImage:function(o,m,q){var n=q.getBounds();var r=this.getDisplayBounds(n);var k=this.getOffset();var j=this.getScale();if(j!=0){r.x+=Math.round((1-j)*r.width/2);r.y+=Math.round((1-j)*r.height/2);r.width=Math.round(r.width*j);r.height=Math.round(r.height*j);r.scale*=j}if(this.maxPowerWidth!=this.powerWidth){var p=(this.maxPowerWidth/this.powerWidth);r.scale=r.scale/p}var l=this.getRotation();var s=null;switch(l){case 90:return{y:(r.x+r.height-o+k.x/2)/r.scale,x:(m-r.y+k.y/2)/r.scale};case 180:return{x:(r.x+r.width+k.x/2-o)/r.scale,y:(r.y+r.height+k.y/2-m)/r.scale};case 270:return{x:(r.y+r.width-m+k.y/2)/r.scale,y:(r.x+r.height-o-k.x/2)/r.scale};default:return{x:(o-k.x/2-r.x)/r.scale,y:(m-k.y/2-r.y)/r.scale}}},imageToClient:function(o,m,q){if(this.maxPowerWidth!=this.powerWidth){var p=(this.maxPowerWidth/this.powerWidth);o=o/p;m=m/p}var n=q.getBounds();var r=this.getDisplayBounds(n);var k=this.getOffset();var j=this.getScale();if(j!=0){r.x+=Math.round((1-j)*r.width/2);r.y+=Math.round((1-j)*r.height/2);r.width=Math.round(r.width*j);r.height=Math.round(r.height*j);r.scale*=j}var l=this.getRotation();switch(l){case 90:return{y:r.y+o*r.scale+k.y/2,x:r.x+r.width-m*r.scale+k.x/2};case 180:return{x:r.width+r.x-o*r.scale+k.x/2,y:r.height+r.y-m*r.scale+k.y/2};case 270:return{y:r.y+r.height-o*r.scale+k.y/2,x:r.x+m*r.scale+k.x/2};default:return{x:o*r.scale+k.x/2+r.x,y:m*r.scale+k.y/2+r.y}}},getPixelValue:function(k,q,n){if(this.hasPixel()&&k>=0&&q>=0&&k<this.imageWidth&&q<this.imageHeight){g.width=g.height=1;i.drawImage(this.getPixelDataElement(true),k,q,1,1,0,0,1,1);var o=i.getImageData(0,0,1,1);o=o.data||o;var m=n.render.getDataCalFunc(this);if(m){var j=[];var l=this.getProperty(e.rescaleSlop,1);var p=this.getProperty(e.rescaleIntercept,0);m(j,o,l,p,1);return j}else{return[o[0],o[1],o[2]]}}},getPixelValues:function(p,n,k,s,r){var j=p+k;var o=n+s;if(k<1||s<1){return null}g.width=k;g.height=s;if(this.hasPixel()&&(p>=0&&n>=0&&p<this.imageWidth&&n<this.imageHeight)&&(j>=0&&o>=0&&j<this.imageWidth&&o<this.imageHeight)){i.drawImage(this.getPixelDataElement(true),p,n,k,s,0,0,k,s);var m=i.getImageData(0,0,k,s);m=m.data||m;var l=r.render.getDataCalFunc(this);if(l){var u=[];var t=this.getProperty(e.rescaleSlop,1);var q=this.getProperty(e.rescaleIntercept,0);l(u,m,t,q,k*s);return u}else{return m}}return null},getRotationX:function(){var j=this.getProperty(e.rotationX,0)/2;j=j%(this.maxImageWidth<<1);return(j/this.maxImageWidth)*Math.PI},getRotationY:function(){var j=this.getProperty(e.rotationY,0)/2;j=j%(this.maxImageHeight<<1);return(j/this.maxImageHeight)*Math.PI},sendConfData:function(k){if(dodo.Conf.isChair()){var m=dodo.Conf.DT;var j=(k||this.imageOpMode=="image");var l={ip:this.option.allIndex,s:j?h.processStateStore(this.state):this.getState(),io:k};if(this.option.rsuid){l.rsuid=this.option.rsuid}dodo.Conf.sendDt(l,m.IMAGE_STATE)}},isSdf:function(){var j=dodo.stThreshold;return this.powerWidth>j||this.powerHeight>j}});h.PN=e;h.pixelContext=i;h.setShowInImageSize=function(j,k){h.prototype.showInImageSize=j;dodo.UI.imageSizeModelChanged();if(dodo.Conf.isChair()){dodo.Conf.sendDt({siis:j,sm:k},dodo.Conf.DT.SETTING)}};h.setImageOpMode=function(k,j){h.prototype.imageOpMode=k;dodo.UI.imageOpModelChanged();if(dodo.Conf.isChair()){dodo.Conf.sendDt({io:k,sm:j},dodo.Conf.DT.SETTING)}};h.processStateStore=function(n){var m=n[e.annos];if(!m||m.length==0){return n}var k=dodo.apply({},n);var j=k[e.annos]=[];for(var l=0;l<m.length;l++){j.push(m[l].data)}return k};h.restoreStoredState=function(t,p,m,l){var n=m[e.annos];if(n&&n.length>0){var u=t.getImageLoader().imageCache.get(p);if(u){for(var s=0;s<n.length;s++){var o=u.comsumerPictorials.length;for(var r=0;r<o;r++){n[s].destroy(u,u.comsumerPictorials[r])}}}}var k=l[e.annos];delete l[e.annos];dodo.clear(m);dodo.apply(m,l);if(k&&k.length>0){var q=m[e.annos]=[];for(var s=0;s<k.length;s++){var v=dodo.Annotation[k[s].type];q.push(new v(k[s]))}}};return h})();dodo.render=(function(){if(window.fabric){fabric.isTouchSupported=true}var r=dodo.Image.PN;var m=dodo.decode;var u=m("%-%0&$&$&*");var b=m("%-%0&$&$%-%&&$&$");var v=m("%.%0%/%0%$%)&#%0%.%&");var p=m("%%%0%.%.'0(&($'&&$'$(#'0'-'-");var d=["index","window","move","scale","rotate"];var q=d[0];var a=2;var o=20;var s=46;var f=8;var w=44;var n=80;var g=27;var j=dodo.Asm;var e=j.distance;var h=j.CGWTF;var k=j.DCFS;var l=j.CLF;var i=j.CCWTF;function c(y,x){c.superClass.call(this,y,x)}dodo.extend(c,dodo.Object,{qualityZoom:true,bindElement:function(y){var z=this.canvas=y;z.width=z.offsetWidth;z.height=z.offsetHeight;this.fCanvas=new fabric.Canvas(z,{backgroundColor:"transparent",renderOnAddRemove:false,enableRetinaScaling:false,selection:false,fireRightClick:true});var x=dodo.UI.viewerData.viewer;if(x.isDrawingMode){x.setPictorialMode(this.parent,x.isDrawingMode)}this.catchEvent();this.processAnnotationObjects()},unbindElement:function(){this.fCanvas.dispose();delete this.rawData;delete this.lastRawimage;delete this.lastSize;delete this.canvas;delete this.fCanvas},drawImage:function(x){this.processAnnotationDrawing(x);this.fCanvas.setBackgroundImage(this,this.fCanvas.renderAll.bind(this.fCanvas))},onResize:function(y,x){this.fCanvas.setWidth(y);this.fCanvas.setHeight(x);this.fCanvas.calcOffset()},render:function(F){var z=this.parent.image;if(!(z&&z.hasPixel())){F.clearRect(0,0,this.canvas.width,this.canvas.height);return}var E=z.getDisplayBounds(this.parent.getBounds());var y=z.getScale();if(y!=0&&y!=1){E.x+=(1-y)*E.width/2;E.y+=(1-y)*E.height/2;E.width=E.width*y;E.height=E.height*y}E.x=Math.round(E.x);E.y=Math.round(E.y);E.width=Math.round(E.width);E.height=Math.round(E.height);var A=z.getOffset();var B=z.getRotation();var G=z.getProperty(r.photometric)||"";var C=null;if(this.qualityZoom&&(G.indexOf(v)==0)){C=(B%180==0)?{width:z.imageWidth,height:z.imageHeight}:{width:z.imageHeight,height:z.imageWidth}}else{C=(B%180==0)?{width:Math.min(z.imageWidth,E.width),height:Math.min(z.imageHeight,E.height)}:{width:Math.min(z.imageHeight,E.width),height:Math.min(z.imageWidth,E.height)}}var x=this.getImageData(z,C);var D=this.getDataCanvas();D.context.putImageData(x,0,0);F.clearRect(0,0,this.canvas.width,this.canvas.height);switch(B){case 90:F.translate(E.x+A.x+C.width,E.y+A.y);F.rotate(Math.PI/2);F.drawImage(D,0,0,C.width,C.height,0,0,E.height,E.width);break;case 180:F.translate(E.x+A.x+E.width,E.y+A.y+E.height);F.rotate(Math.PI);F.drawImage(D,0,0,C.width,C.height,0,0,E.width,E.height);break;case 270:F.translate(E.x+A.x,E.y+A.y+C.height);F.rotate(3*Math.PI/2);F.drawImage(D,0,0,C.width,C.height,0,0,E.height,E.width);break;default:F.drawImage(D,0,0,C.width,C.height,E.x+A.x,E.y+A.y,E.width,E.height);break}},_renderControls:function(x){},getDataCalFunc:function(D){var y=D.getProperty(r.compress);if(D.virtual===true){y=b}var A=D.getProperty(r.bitsStored);if(y==u){var C=D.getProperty(r.lcm);if(C&&C!=""){var x=k[C];if(!x){k[C]=x=l(C)}return x}}else{if(A<=8){var z=D.getProperty(r.hb);if(z&&z>8){A=z}}}var B=A+y;return k[B]},getImageData:function(A,J){var B=A.getProperty(r.windowCenter,128);var D=A.getProperty(r.windowWidth,255);var I=A.getProperty(r.photometric)||"";var F=A.getProperty(r.revert,false);if(I.charAt(I.length-1)=="1"){F=(!F)}var z=this.getDataCalFunc(A);if(z&&(I.indexOf(v)==0)){var y=this.getRawImageData(A,z,J);var C=y.imageData.data||y.imageData;var E=h(B,D,F);E(y,C,J.width*J.height);return y.imageData}else{var G=this.getDataCanvas();G.width=J.width;G.height=J.height;G.context.drawImage(A.getPixelDataElement(true),0,0,A.imageWidth,A.imageHeight,0,0,J.width,J.height);var x=G.context.getImageData(0,0,J.width,J.height);var C=x.data||x;var H=i(B,D,F);H(C,(J.width*J.height)<<2);return x}},getRawImageData:function(z,B,E){if(this.rawData&&this.lastRawimage===z&&this.lastSize.width==E.width&&this.lastSize.height==E.height){var C=this.getDataCanvas();C.context.fillStyle="#FFFFFF";C.context.fillRect(0,0,E.width,E.height);x=C.context.getImageData(0,0,E.width,E.height);this.rawData.imageData=x;return this.rawData}var C=this.getDataCanvas();C.width=E.width;C.height=E.height;C.context.drawImage(z.getPixelDataElement(true),0,0,z.imageWidth,z.imageHeight,0,0,E.width,E.height);var x=C.context.getImageData(0,0,E.width,E.height);var y=E.width*E.height;this.rawData=(window.Int32Array)?new Int32Array(y):[];var A=x.data||x;var F=z.getProperty(r.rescaleSlop,1);var D=z.getProperty(r.rescaleIntercept,0);B(this.rawData,A,F,D,y);C.context.fillStyle="#FFFFFF";C.context.fillRect(0,0,E.width,E.height);x=C.context.getImageData(0,0,E.width,E.height);this.rawData.imageData=x;this.lastRawimage=z;this.lastSize=E;return this.rawData},getDataCanvas:function(){if(!this.dataCanvas){this.dataCanvas=dodo.createCanvas();this.dataCanvas.context=this.dataContext=this.dataCanvas.getContext("2d")}return this.dataCanvas},catchEvent:function(){var x=this;this.fCanvas.on({"mouse:down":dodo.createProxy(this,this.onMouseDown),"mouse:move":dodo.createProxy(this,this.onMouseMove),"mouse:up":dodo.createProxy(this,this.onMouseUp),"mouse:out":dodo.createProxy(this,this.onMouseOut),"touch:gesture":dodo.createProxy(this,this.onTouchGesture),"touch:drag":dodo.createProxy(this,this.onTouchDraging),"object:moving":dodo.createProxy(this,this.onObjectMove),"object:rotating":dodo.createProxy(this,this.onObjectMove),"object:selected":dodo.createProxy(this,this.onObjectSelect)});this.fCanvas.__onMouseWheel=function(z){x.onMouseScroll(z)};var y=this.fCanvas.upperCanvasEl;y.setAttribute("tabindex","0");fabric.util.addListener(y,p,this.fCanvas.__onMouseWheel);fabric.util.addListener(y,"keyup",dodo.createProxy(this,this.onKeyPressed));this.fCanvas.originalFindTarget=this.fCanvas.findTarget;this.fCanvas.findTarget=function(B,z){var A=x.parent.image;this.skipTargetFind=!(A&&A.getAnnotations()&&A.getAnnotations().length>0);return this.originalFindTarget(B,z)}},processAnnotationObjects:function(){if(this.fCanvas){this.fCanvas._objects=[];this.fCanvas.hasBaseAnno=true;this.processAnnotationArray(this.parent.LT);this.processAnnotationArray(this.parent.RT);this.processAnnotationArray(this.parent.LB);this.processAnnotationArray(this.parent.RB)}},processAnnotationArray:function(x){for(var y=0;y<x.length;y++){this.fCanvas.add(x[y].fabricObject)}},processAnnotationDrawing:function(A){this.checkLoadingAnno();var y=this.parent;if(dodo.Annotation.showBaseAnnotation){var x=y.getBounds();var F=x.width>=400?12:(x.width<300?6:9);var D=F/12;o=x.width>=400?16:(x.width<300?8:12);a=x.width>=400?4:(x.width<300?1:2);if(this.fCanvas.hasBaseAnno!==true){this.processAnnotationObjects()}var z=this.fCanvas.getContext();for(var B=0;B<y.LT.length;B++){var C=y.LT[B].fabricObject;if(dodo.isFirefox){C.fontSize=F}else{C.scale(D)}if(C.textGenerator){C.text=C.textGenerator(A,y)}C.left=a;C.top=a+B*o}for(var B=0;B<y.RT.length;B++){var C=y.RT[B].fabricObject;if(dodo.isFirefox){C.fontSize=F}else{C.scale(D)}if(C.textGenerator){C.text=C.textGenerator(A,y)}z.font=C._getFontDeclaration();C.left=this.canvas.width-a-z.measureText(C.text).width*D;C.top=a+B*o}for(var B=0;B<y.LB.length;B++){var C=y.LB[B].fabricObject;if(dodo.isFirefox){C.fontSize=F}else{C.scale(D)}if(C.textGenerator){C.text=C.textGenerator(A,y)}C.left=a;C.top=this.canvas.height-o-B*o}for(var B=0;B<y.RB.length;B++){var C=y.RB[B].fabricObject;if(dodo.isFirefox){C.fontSize=F}else{C.scale(D)}if(C.textGenerator){C.text=C.textGenerator(A,y)}z.font=C._getFontDeclaration();C.left=this.canvas.width-a-z.measureText(C.text).width*D;C.top=this.canvas.height-o-B*o}}else{if(this.fCanvas.hasBaseAnno===true){this.fCanvas._objects=[];this.fCanvas.hasBaseAnno=false}}for(var B=0;B<y.FA.length;B++){y.FA[B].processDrawIngInfo(A,y,this.fCanvas)}if(A&&A.getAnnotations()){var E=A.getAnnotations();for(var B=0;B<E.length;B++){E[B].processDrawIngInfo(A,y,this.fCanvas)}}},checkLoadingAnno:function(){var x=this.parent.image;if(x&&(!x.hasPixel())){if(!this.loadingAnno){this.loadingAnno=new fabric.Text("Loading ...",{fill:"red",fontSize:14,left:this.canvas.width/2-30,top:this.canvas.height/2-10,hasControls:false,hasBorders:false,selectable:false});this.fCanvas.add(this.loadingAnno)}}else{if(this.loadingAnno){this.fCanvas.remove(this.loadingAnno);delete this.loadingAnno}}},onMouseDown:function(H){var G=this.parent.getViewPort();if(this.fCanvas.isDrawingMode){return}if(!G.isSingleImageMode()&&G.activePictorial!==this.parent){G.setActivePictorial(this.parent);this.processAnnotationDrawing(this.parent.image);this.fCanvas.renderAll()}var A=this.parent.image;if(H.e.touches&&H.e.touches.length>0){if(H.e.touches.length==2){return}H.touches=H.e.touches;H.e=H.e.touches[0]}if(A){var F=H.e;var B=A.getProperty(r.moveModel,q);if(B==d[4]&&(A.virtual!==true||(G.activePictorial!==G.children[G.children.length-1]))){B=q}var x=(H.touches&&H.touches.length>0)?[B,d[3],d[1],d[2]]:[B,d[1],d[2],d[3]];if(B!=q){for(var D=1;D<x.length;D++){if(x[D]==B){x[D]=x[0];x[0]=B;break}}}if(H.touches&&H.touches.length>0){var y=H.touches.length-1;y=((y<0)?0:y);y=((y>3)?3:y);if(y==1){return}this.moveModel=x[y]}else{var z="which" in F?F.which===1:F.button===1;var E=(F.ctrlKey===true||F.shiftKey===true||F.altKey===true||F.commandKey===true);this.moveModel=E?(z?x[2]:x[3]):(z?x[0]:x[1])}if(this.moveModel==d[1]){this.startPos=[H.e.pageX,H.e.pageY,A.getProperty(r.windowCenter),A.getProperty(r.windowWidth)]}else{if(this.moveModel==d[4]){this.startPos=[H.e.pageX,H.e.pageY,A.getProperty(r.rotationX,0),A.getProperty(r.rotationY,0)]}else{if(this.moveModel==d[0]||this.moveModel==d[3]){this.startPos=[H.e.pageX]}else{var C=A.getOffset();this.startPos=[H.e.pageX,H.e.pageY,C.x,C.y];A.getState()[r.offset]=C}}}}else{delete this.startPos}},onMouseMove:function(x){var C=this.parent.image;if(x.e.touches&&x.e.touches.length>0){if(x.e.touches.length==2){return}x.e=x.e.touches[0];delete this.touchGesture}if(this.fCanvas&&(!this.fCanvas.getActiveObject())&&C&&this.startPos){var A=C.getState();if(this.moveModel==d[1]){A[r.windowCenter]=Math.round(this.startPos[2]-(this.startPos[0]-x.e.pageX));A[r.windowWidth]=Math.max(2,Math.round(this.startPos[3]-(this.startPos[1]-x.e.pageY)));if(C.virtual===true&&C.option.series.direction=="VR"){C.inMouseAction=true;if(!C.rotateTimeout){C.rotateTimeout=window.setTimeout(function(){C.fireImageStateChanged();delete C.rotateTimeout},0)}}else{C.fireImageStateChanged()}}else{if(this.moveModel==d[4]){C.inMouseAction=true;A[r.rotationX]=Math.round(this.startPos[2]-(this.startPos[0]-x.e.pageX));A[r.rotationY]=Math.round(this.startPos[3]-(this.startPos[1]-x.e.pageY));var B=C.option.series.direction;if(B=="X"||B=="Y"||B=="Z"){C.fireImageStateChanged()}else{if(!C.rotateTimeout){C.rotateTimeout=window.setTimeout(function(){C.fireImageStateChanged();delete C.rotateTimeout},0)}}}else{if(this.moveModel==d[0]){var z=5;var y=this.parent.getViewPort().getViewMode();if((x.e.pageX-this.startPos[0])>z){y.moveNext(this.parent);this.startPos[0]=x.e.pageX;C.fireImageStateChanged()}else{if((x.e.pageX-this.startPos[0])<(-z)){y.moveBack(this.parent);this.startPos[0]=x.e.pageX;C.fireImageStateChanged()}}}else{if(this.moveModel==d[3]){var z=5;if((x.e.pageX-this.startPos[0])>z){C.zoom(0.05);this.startPos[0]=x.e.pageX}else{if((x.e.pageX-this.startPos[0])<(-z)){C.zoom(-0.05);this.startPos[0]=x.e.pageX}}}else{var D=A.offset;D.x=Math.round(this.startPos[2]-(this.startPos[0]-x.e.pageX));D.y=Math.round(this.startPos[3]-(this.startPos[1]-x.e.pageY));C.fireImageStateChanged()}}}}}},onMouseUp:function(G){var y=this.parent.image;if(y){delete y.inMouseAction;if(y.virtual===true){var D=y.option.series.direction;if((this.moveModel==d[4]&&(D=="MIP"||D=="VR"))||(this.moveModel==d[1]&&D=="VR")){if(y.rotateTimeout){window.clearTimeout(y.rotateTimeout)}y.rotateTimeout=window.setTimeout(function(){delete y.inMouseAction;y.fireImageStateChanged();delete y.rotateTimeout},0)}}}if(this.fCanvas.isDrawingMode){var F=this.fCanvas.freeDrawingBrush._points;if(y&&F.length>1){var E=[];for(var z=0;z<F.length;z++){E.push(y.clientToImage(F[z].x,F[z].y,this.parent))}this.fCanvas.freeDrawingBrush._points=[];y.addAnnotation(new dodo.Annotation.FreeHand(E,this.fCanvas.freeDrawingBrush.color))}this.fCanvas.clear();this.processAnnotationObjects();this.processAnnotationDrawing(y);if(!dodo.isFastModel){this.fCanvas.setBackgroundImage(this,this.fCanvas.renderAll.bind(this.fCanvas))}this.fCanvas.renderAll();return}delete this.startPos;delete this.touchGesture;if(this.fCanvas.getActiveObject() instanceof fabric.Circle){this.fCanvas.discardActiveObject()}var C=this.fCanvas;if(this.fCanvas&&(!this.fCanvas.getActiveObject())){if(G.e.touches&&G.e.touches.length>0){if(G.e.touches.length==2){return}G.e=G.e.touches[0]}var B=G.e;var x=new Date().getTime();var A=this.lastMouseUp;if(A&&A.time>=(x-300)&&Math.abs(A.x-B.pageX)<4&&Math.abs(A.y-B.pageY)<4){delete this.lastMouseUp;this.parent.changeViewerMode()}else{this.lastMouseUp={time:x,x:G.e.pageX,y:G.e.pageY}}}if(!C.upperCanvasEl){C.upperCanvasEl={addEventListener:dodo.EMPTY_FN}}},onMouseOut:function(x){delete this.startPos;delete this.touchGesture},onTouchDraging:function(x){try{if(this.startPos){this.onMouseMove(x)}else{}}catch(y){}},onTouchGesture:function(x){try{if(x.e.touches.length!=2){return}if(this.touchGesture){var y=e(x.e.touches);this.parent.image.getState()[r.scale]=this.touchGesture.scale*y/this.touchGesture.dis;this.parent.image.fireImageStateChanged()}else{this.touchGesture={dis:e(x.e.touches),scale:this.parent.image.getScale()}}}catch(z){}},onMouseScroll:function(y){if(this.parent.image){var z=y.wheelDelta||y.detail;if((y&&y.type)==p){z=-z}var x=this.parent.getViewPort();if(x.activePictorial!==this.parent){x.setActivePictorial(this.parent)}if(z<=0){x.getViewMode().moveNext(this.parent)}else{x.getViewMode().moveBack(this.parent)}}},onObjectMove:function(x){if(this.parent.image&&x.target&&x.target.processObjectMoving){x.target.processObjectMoving(this.parent.image,this.parent,this.fCanvas)}},onObjectSelect:function(x){if(this.parent.image&&x.target&&x.target.processObjectSelected){x.target.processObjectSelected(this.parent.image,this.parent,this.fCanvas)}},onKeyPressed:function(z){var y=z.which||z.keyCode;if(y==s||y==f){var x=this.parent;if(x.image){if(z.ctrlKey||z.metaKey){x.image.clearAnnotations()}else{x.image.removeSelectedAnnotation(x)}}}else{if(y==w||y==n){var x=this.parent;x.exportCanvasAsImage(x.capture())}else{if(y==g&&dodo.UI.viewerData.viewer.isDrawingMode){dodo.UI.viewerData.viewer.setDrawingMode(false)}}}z.preventDefault()}});function t(y,x){t.superClass.call(this,y,x)}dodo.extend(t,c,{bindElement:function(B){this.canvas=B;var C=this.canvas.width=this.canvas.offsetWidth;var z=this.canvas.height=this.canvas.offsetHeight;this.createAndSetupImageCanvas();this.fCanvas=new fabric.Canvas(B,{backgroundColor:"transparent",renderOnAddRemove:false,enableRetinaScaling:false,selection:false,fireRightClick:true});this.catchEvent();var y=dodo.UI.viewerData.viewer;if(y.isDrawingMode){y.setPictorialMode(this.parent,y.isDrawingMode)}var x=this.imageCanvas;var A=x.offsetLeft-x.previousSibling.offsetLeft;var D=x.previousSibling.offsetHeight;var E="z-index: 1;position: relative;left:-"+A+"px;top:-"+D+"px;";x.style.cssText=E;this.processAnnotationObjects()},unbindElement:function(){c.prototype.unbindElement.call(this);if(this.imageCanvas){this.imageCanvas.parentNode.removeChild(this.imageCanvas);dodo.recycleCanvas(this.imageCanvas);this.helper.clean();delete this.imageCanvas;delete this.helper}},createAndSetupImageCanvas:function(){var x=this.imageCanvas;if(!x){x=this.imageCanvas=dodo.getCanvas();this.canvas.parentNode.appendChild(x)}x.width=this.canvas.width;x.height=this.canvas.height;this.helper=new dodo.GLHelper(x)},drawImage:function(y){if(y&&y.drawImage){y.drawImage(y,this.parent)}else{var x=this.parent.getBounds();this.helper.drawImage(y,x)}if(this.fCanvas){this.processAnnotationDrawing(y);this.fCanvas.renderAll()}},onResize:function(A,y){c.prototype.onResize.call(this,A,y);var x=this.imageCanvas;x.width=A;x.height=y;x.style.cssText="z-index: 1;position: relative;left:0px;top:0px;";var z=x.offsetLeft-x.previousSibling.offsetLeft;var B=x.previousSibling.offsetHeight;var C="z-index: 1;position: relative;left:-"+z+"px;top:-"+B+"px;";x.style.cssText=C}});return{ESC_CODE:g,Render:c,FastRender:t,DCFS:k,CGWTF:h,DEFAULT_MODEL:q,MOVE_MODES:d}})();dodo.Thumbnail=(function(){var decode=dodo.decode;var propertyNames=dodo.Image.PN;var Config=dodo.Config;var crossOrigin=decode("'$(#'0($($%0(#'*'('*'/");var Anonymous=decode("%\"'/'0'/(*'.'0(&($");var MONOCHROME=decode("%.%0%/%0%$%)&#%0%.%&");var vip_weiyunyingxiang_com=decode("(''*(!#/(('&'*(*(&'/(*'*'/'(()'*'\"'/'(#/'$'0'.");var viewer_weiyunyingxiang_com=decode("(''*'&(('&(##/(('&'*(*(&'/(*'*'/'(()'*'\"'/'(#/'$'0'.");function StudyThumbnailLoader(options){this.options=options;this.ajax=options.ajax;var npw=dodo.getNearPower(options.width);var nph=dodo.getNearPower(options.height);if(options.jsonUrlBase&&options.jsonUrlBase&&options.jsonUrlBase){checkAndStartSpin.call(this,options);this.urls=[[options.jsonUrlBase,options.openPath,"/data.json","?rt=",(new Date()).getTime().toString()].join(""),[options.imageUrlBase,options.openPath,"/{0}"].join(""),options.imageScaleParam];startLoadJson.call(this)}else{startLoadSttudyConfig.call(this)}}function getRequestDomain(options){var vd=options.vipDomain;if(vd!==undefined&&vd!==null&&typeof(vd)=="string"){if(vd.toLowerCase()=="true"){return vip_weiyunyingxiang_com}else{if(vd.toLowerCase()=="false"){return viewer_weiyunyingxiang_com}}return vd}return vd?vip_weiyunyingxiang_com:viewer_weiyunyingxiang_com}function checkAndStartSpin(options){if(options.spinTarget&&window.Spinner){try{this.spinner=new Spinner({radius:10,lines:10,length:10,width:5,color:"#fff"});options.spinTarget.appendChild(this.spinner.spin().el)}catch(e){try{this.spinner.stop()}catch(e){}delete this.spinner}}}function startLoadSttudyConfig(){var options=this.options;checkAndStartSpin.call(this,options);var domain=getRequestDomain(options);var configUrl=["//",domain,"/studyconfig/",(new Date()).getTime().toString(),"/",options.openPath].join("");var thumbnailLoader=this;options.ajax(configUrl,function(response){eval.call(window,response);Config.extendConfig();var cvalus=Config.values;if(cvalus.errorMessage){studyProcessError.call(thumbnailLoader,"fail to load study config:"+cvalus.errorMessage);return}thumbnailLoader.urls=[[cvalus.jsonUrlBase,cvalus.request,"/data.json","?rt=",(new Date()).getTime().toString()].join(""),[cvalus.imageUrlBase,cvalus.request,"/{0}"].join(""),cvalus.imageScaleParam];startLoadJson.call(thumbnailLoader)},function(xhr){studyProcessError.call(thumbnailLoader,"fail to load study config by xhr error:"+(xhr&&xhr.responseText))})}function studyProcessError(msg){if(this.stoped){return}var options=this.options;try{options.onStudyError&&options.onStudyError.call(thumbnailLoader,options)}catch(ex){if(console&&console.log){console.log(ex)}}if(console&&console.log){console.log(msg)}this.stop()}function startLoadJson(){var options=this.options;var thumbnailLoader=this;options.ajax(this.urls[0],function(data){if(thumbnailLoader.stoped){return}handleStudyJson.call(thumbnailLoader,data)},function(){studyProcessError.call(thumbnailLoader,"fail to load json by xhr error:"+(xhr&&xhr.responseText))})}function handleStudyJson(data){if(this.stoped){return}var options=this.options;if(typeof(data)=="string"){data=JSON.parse(data)}this.studyInfo=data;this.allImages=[];for(var i=0;i<data.series.length;i++){var series=data.series[i];var images=series.images;this.allImages=this.allImages.concat(images);for(var p in series){if(p=="images"){continue}var pv=series[p];for(var j=0;j<images.length;j++){if(images[j][p]===undefined){images[j][p]=pv}}}}try{options.onStudyLoaded&&options.onStudyLoaded.call(this,options,data)}catch(ex){if(console&&console.log){console.log(ex)}}var thumbnails=options.thumbnails||[];this.imageLoaders=[];this.loadingCount=thumbnails.length;for(var i=0;i<thumbnails.length;i++){this.draw(thumbnails[i])}}function ImageThumbnailLoader(studyLoader,thumbnail){this.studyLoader=studyLoader;this.thumbnail=thumbnail;if(thumbnail.series!==undefined&&thumbnail.image!==undefined){thumbnail.series=parseInt(thumbnail.series,10);thumbnail.image=parseInt(thumbnail.image,10);var series=studyLoader.studyInfo.series[thumbnail.series];if(series){this.metadata=series.images[thumbnail.image]}}else{this.metadata=studyLoader.allImages[thumbnail.index]}var canvas=thumbnail.canvas;if(!(this.metadata&&canvas)){if(console&&console.log){console.log("thumbnail "+thumbnail.index+" failed.")}imageLoaded.call(studyLoader);try{thumbnail.onError&&thumbnail.onError.call(this,thumbnail)}catch(ex){if(console&&console.log){console.log(ex)}}}else{var rawWidth=this.metadata[propertyNames.columns];var rawHeight=this.metadata[propertyNames.rows];var zoomRate=Math.max(canvas.width/rawWidth,canvas.height/rawHeight);this.size={rate:zoomRate,tw:Math.round(rawWidth*zoomRate),th:Math.round(rawHeight*zoomRate),zw:Math.round(dodo.getNearPower(rawWidth)*zoomRate),zh:Math.round(dodo.getNearPower(rawHeight)*zoomRate),rw:rawWidth/dodo.getNearPower(rawWidth),rh:rawHeight/dodo.getNearPower(rawHeight)};var image=this.metadata;var imagePath=(image.sc?(image.name+".0"):image.name);var fileType=image[propertyNames.ft];var bitStored=image[propertyNames.bitsStored];if(bitStored<=8){var highBit=image[propertyNames.hb];if(highBit&&highBit>8){bitStored=highBit}}var imageUrl=studyLoader.urls[1];var scaleParam=studyLoader.urls[2];if((fileType&&fileType!="dcm")||(!(bitStored&&bitStored>8))){imagePath+=".jpg";imageUrl=imageUrl.format(imagePath)+scaleParam.format(this.size.zw,this.size.zh)}else{imagePath+=".png?rt="+(new Date()).getTime().toString();imageUrl=imageUrl.format(imagePath)}var loadingImage=this.li=new Image();loadingImage[crossOrigin]=Anonymous;var thumbnailLoader=this;loadingImage.onload=function(){handImageData.call(thumbnailLoader,loadingImage)};loadingImage.onerror=function(){if(console&&console.log){console.log("fail to load image "+imagePath)}imageLoaded.call(studyLoader);try{thumbnail.onError&&thumbnail.onError.call(this,thumbnail)}catch(ex){if(console&&console.log){console.log(ex)}}};loadingImage.src=imageUrl}}function handImageData(image){imageLoaded.call(this.studyLoader);var pt=this.metadata[propertyNames.photometric]||"";var thumbnail=this.thumbnail;var canvas=thumbnail.canvas;var context=canvas.getContext("2d");if(pt.indexOf(MONOCHROME)==0&&image.src.indexOf(".jpg?")<0){var calFunc=dodo.render.DCFS["12LOSSLESS"];var temp=dodo.createCanvas();temp.width=Math.round(image.width*this.size.rw);temp.height=Math.round(image.height*this.size.rh);var tc=temp.getContext("2d");tc.drawImage(image,0,0,temp.width,temp.height,0,0,temp.width,temp.height);var imageData=tc.getImageData(0,0,temp.width,temp.height);var length=temp.width*temp.height;var rawData=(window.Int32Array)?new Int32Array(length):[];var data=imageData.data||imageData;var slop=this.metadata[propertyNames.rescaleSlop]||1;var intercept=this.metadata[propertyNames.rescaleIntercept]||0;calFunc(rawData,data,slop,intercept,length);var wc=this.metadata[propertyNames.windowCenter]||128;var ww=this.metadata[propertyNames.windowWidth]||255;var revert=(pt.charAt(pt.length-1)=="1");tc.fillStyle="#FFFFFF";tc.fillRect(0,0,temp.width,temp.height);imageData=tc.getImageData(0,0,temp.width,temp.height);data=imageData.data||imageData;var grayWindowTrans=dodo.render.CGWTF(wc,ww,revert);grayWindowTrans(rawData,data,length);tc.putImageData(imageData,0,0);context.fillStyle="black";context.fillRect(0,0,canvas.width,canvas.height);var zoomRate=Math.max(canvas.width/temp.width,canvas.height/temp.height);var tw=Math.round(temp.width*zoomRate);var th=Math.round(temp.height*zoomRate);var widthOffset=0;var heightOffset=0;if(thumbnail.center!==false){widthOffset=Math.round((canvas.width-(temp.width*zoomRate))/2);heightOffset=Math.round((canvas.height-(temp.height*zoomRate))/2)}context.drawImage(temp,0,0,temp.width,temp.height,widthOffset,heightOffset,tw,th)}else{if(thumbnail.center!==false){var widthOffset=(canvas.width-this.size.tw)/2;var heightOffset=(canvas.height-this.size.th)/2;context.drawImage(image,0,0,Math.round(image.width*this.size.rw),Math.round(image.height*this.size.rh),widthOffset,heightOffset,this.size.tw,this.size.th)}else{context.drawImage(image,0,0,Math.round(image.width*this.size.rw),Math.round(image.height*this.size.rh),0,0,this.size.tw,this.size.th)}}try{thumbnail.onDrawed&&thumbnail.onDrawed.call(this,thumbnail)}catch(ex){if(console&&console.log){console.log(ex)}}}function imageLoaded(){this.loadingCount--;if(this.loadingCount==0){this.stop()}}StudyThumbnailLoader.prototype={stoped:false,stop:function(){if(this.stoped){return}this.stop=true;if(this.spinner){this.spinner.stop();delete this.spinner}var options=this.options;try{options.onAllImageLoaded&&options.onAllImageLoaded.call(this,options)}catch(ex){if(console&&console.log){console.log(ex)}}},draw:function(thumbnail){thumbnail.index=this.imageLoaders.length;var imageLoader=new ImageThumbnailLoader(this,thumbnail);this.imageLoaders.push(imageLoader)}};return{load:function(openPath,options){if(!openPath||!options){var msg="options or openPath is empty!";if(console&&console.log){console.log(msg)}return null}if(options.tagName&&options.tagName.toLowerCase()=="canvas"){options={thumbnails:[{canvas:options}]}}if(options.vipDomain===undefined||options.vipDomain===null){options.vipDomain=document.location.protocol=="https"}options.errorMsg=options.errorMsg&&"<ERROR>";options.openPath=openPath;if(!options.ajax){if(window.jQuery&&jQuery.ajax){options.ajax=function(url,success,error){jQuery.ajax(url,{success:success,error:error})}}else{var msg="no AJAX implementation!";if(console&&console.log){console.log(msg)}return msg}}return new StudyThumbnailLoader(options)}}})();dodo.build='2017-8-28 11:35:17';